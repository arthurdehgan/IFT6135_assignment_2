Using the GPU

########## Setting Up Experiment ######################

Putting log in TRANSFORMER_SDG_LR_SCHEDULE_model=TRANSFORMER_optimizer=SDG_LR_SCHEDULE_initial_lr=20_batch_size=128_seq_len=35_hidden_size=512_num_layers=6_dp_keep_prob=0.9_save_best_0
Using the GPU
Loading data from data
  vocabulary size: 10000

########## Running Main Loop ##########################

EPOCH 0 ------------------
step: 10	loss: 7618.98886680603	speed (wps):20949.53106950953
step: 30	loss: 20959.978790283203	speed (wps):23955.229372768994
step: 50	loss: 30473.324298858643	speed (wps):24734.525455486597
step: 70	loss: 38844.91216659546	speed (wps):25075.90235653568
step: 90	loss: 47124.39218521118	speed (wps):25278.729540659733
step: 110	loss: 54648.83746623993	speed (wps):25408.948518331155
step: 130	loss: 62741.69812679291	speed (wps):25502.490860665053
step: 150	loss: 70064.77638244629	speed (wps):25573.822030542327
step: 170	loss: 76983.72212409973	speed (wps):25628.73969845549
step: 190	loss: 83556.0988521576	speed (wps):25664.33486928722
Saving model parameters to best_params.pt
epoch: 0	train ppl: 203757.33367416434	val ppl: 3069.5499556084583	best val: 3069.5499556084583	time (s) spent in epoch: 37.6262264251709

EPOCH 1 ------------------
step: 10	loss: 3720.141236782074	speed (wps):24851.88936605922
step: 30	loss: 9941.510848999023	speed (wps):25607.550559426818
step: 50	loss: 15932.982559204102	speed (wps):25776.684721189304
step: 70	loss: 22084.477157592773	speed (wps):25850.97880384164
step: 90	loss: 27765.57267189026	speed (wps):25895.39839324801
step: 110	loss: 33417.445805072784	speed (wps):25922.935097642054
step: 130	loss: 39163.43122243881	speed (wps):25941.358887702383
step: 150	loss: 44515.92447280884	speed (wps):25954.43291568748
step: 170	loss: 49705.88756799698	speed (wps):25965.151677076978
step: 190	loss: 55197.27198123932	speed (wps):25972.848118831622
Saving model parameters to best_params.pt
epoch: 1	train ppl: 3601.038167234069	val ppl: 2068.2414458277262	best val: 2068.2414458277262	time (s) spent in epoch: 36.784979581832886

EPOCH 2 ------------------
step: 10	loss: 2871.4278531074524	speed (wps):24857.657645869782
step: 30	loss: 7997.71782875061	speed (wps):25612.182674123113
step: 50	loss: 13262.210783958435	speed (wps):25781.019516066714
step: 70	loss: 18204.60087299347	speed (wps):25859.335142026055
step: 90	loss: 23204.202251434326	speed (wps):25898.551762393436
step: 110	loss: 28082.01230764389	speed (wps):25924.816481619724
step: 130	loss: 32915.84829330444	speed (wps):25943.836548019557
step: 150	loss: 37684.641885757446	speed (wps):25960.73971639876
step: 170	loss: 42457.054052352905	speed (wps):25970.79413408707
step: 190	loss: 47148.40576887131	speed (wps):25977.452665029996
Saving model parameters to best_params.pt
epoch: 2	train ppl: 1132.2561072981646	val ppl: 661.6603628782505	best val: 661.6603628782505	time (s) spent in epoch: 36.77604603767395

EPOCH 3 ------------------
step: 10	loss: 2627.3040747642517	speed (wps):24864.295974370547
step: 30	loss: 7329.2313504219055	speed (wps):25615.951303280177
step: 50	loss: 12136.233561038971	speed (wps):25784.442752533356
step: 70	loss: 16845.745906829834	speed (wps):25855.002720820943
step: 90	loss: 21541.43332004547	speed (wps):25896.33020449139
step: 110	loss: 26052.18600988388	speed (wps):25923.199293330697
step: 130	loss: 30540.065729618073	speed (wps):25942.443728613096
step: 150	loss: 35024.96791124344	speed (wps):25955.55498766171
step: 170	loss: 39434.5938706398	speed (wps):25967.11553467095
step: 190	loss: 43935.69638967514	speed (wps):25975.156485684878
Saving model parameters to best_params.pt
epoch: 3	train ppl: 702.2056992926377	val ppl: 508.87465316179754	best val: 508.87465316179754	time (s) spent in epoch: 36.80380654335022

EPOCH 4 ------------------
step: 10	loss: 2398.219141960144	speed (wps):24841.253465025016
step: 30	loss: 6805.118086338043	speed (wps):25604.26270744167
step: 50	loss: 11230.0191116333	speed (wps):25773.175513784863
step: 70	loss: 15658.537242412567	speed (wps):25850.31862434081
step: 90	loss: 20081.03527545929	speed (wps):25894.338029708102
step: 110	loss: 24446.210718154907	speed (wps):25920.83428921433
step: 130	loss: 28813.102922439575	speed (wps):25936.7495991481
step: 150	loss: 33206.14393949509	speed (wps):25951.35685624427
step: 170	loss: 37661.90556764603	speed (wps):25962.582051214467
step: 190	loss: 42074.971091747284	speed (wps):25971.72603983217
epoch: 4	train ppl: 542.3036053159851	val ppl: 648.916221711822	best val: 508.87465316179754	time (s) spent in epoch: 36.59215426445007

EPOCH 5 ------------------
step: 10	loss: 2456.2387776374817	speed (wps):24843.143427402887
step: 30	loss: 6864.296126365662	speed (wps):25616.3613465622
step: 50	loss: 11237.513675689697	speed (wps):25783.702535018943
step: 70	loss: 15671.940836906433	speed (wps):25852.429013010507
step: 90	loss: 20082.290861606598	speed (wps):25895.501532353646
step: 110	loss: 24428.757581710815	speed (wps):25922.510140508708
step: 130	loss: 28748.098781108856	speed (wps):25939.967154377053
step: 150	loss: 33081.146886348724	speed (wps):25955.84347508059
step: 170	loss: 37422.60402917862	speed (wps):25965.576780155498
step: 190	loss: 41741.452593803406	speed (wps):25973.074049980853
Saving model parameters to best_params.pt
epoch: 5	train ppl: 515.6055479519521	val ppl: 445.91267515617426	best val: 445.91267515617426	time (s) spent in epoch: 36.78952884674072

EPOCH 6 ------------------
step: 10	loss: 2363.9657378196716	speed (wps):24807.190950822318
step: 30	loss: 6680.4129457473755	speed (wps):25589.372708095736
step: 50	loss: 10960.084612369537	speed (wps):25758.247457328995
step: 70	loss: 15314.083731174469	speed (wps):25833.310348604136
step: 90	loss: 19670.75138568878	speed (wps):25878.63215877382
step: 110	loss: 23943.11223745346	speed (wps):25904.35921916448
step: 130	loss: 28162.30469942093	speed (wps):25923.86251168971
step: 150	loss: 32363.618681430817	speed (wps):25935.49817042833
step: 170	loss: 36525.60359239578	speed (wps):25948.95463037641
step: 190	loss: 40711.777408123016	speed (wps):25958.276723441828
epoch: 6	train ppl: 439.9447255973615	val ppl: 507.8211261763052	best val: 445.91267515617426	time (s) spent in epoch: 36.61215138435364

EPOCH 7 ------------------
step: 10	loss: 2319.536883831024	speed (wps):24845.63694566495
step: 30	loss: 6551.045565605164	speed (wps):25607.524667530324
step: 50	loss: 10720.92323064804	speed (wps):25774.584073313712
step: 70	loss: 14906.308176517487	speed (wps):25846.41934437149
step: 90	loss: 19105.53457736969	speed (wps):25882.668789833984
step: 110	loss: 23252.90096282959	speed (wps):25912.348505558173
step: 130	loss: 27418.821160793304	speed (wps):25931.306828011853
step: 150	loss: 31584.836938381195	speed (wps):25944.205783574627
step: 170	loss: 35714.12480592728	speed (wps):25954.753996423864
step: 190	loss: 39830.74035406113	speed (wps):25960.319043139374
Saving model parameters to best_params.pt
epoch: 7	train ppl: 385.392028704554	val ppl: 363.3069666478534	best val: 363.3069666478534	time (s) spent in epoch: 36.810004234313965

EPOCH 8 ------------------
step: 10	loss: 2271.1073541641235	speed (wps):24850.07873818843
step: 30	loss: 6394.166774749756	speed (wps):25599.078824190885
step: 50	loss: 10505.595638751984	speed (wps):25767.137505206858
step: 70	loss: 14584.666368961334	speed (wps):25841.093665262204
step: 90	loss: 18691.615691184998	speed (wps):25880.91962430046
step: 110	loss: 22768.507299423218	speed (wps):25907.816293874293
step: 130	loss: 26759.546942710876	speed (wps):25923.22694294315
step: 150	loss: 30810.281159877777	speed (wps):25938.167365172256
step: 170	loss: 34839.59873199463	speed (wps):25948.113489004238
step: 190	loss: 38813.50705862045	speed (wps):25958.5024011554
Saving model parameters to best_params.pt
epoch: 8	train ppl: 331.23519527542993	val ppl: 299.3225766952304	best val: 299.3225766952304	time (s) spent in epoch: 36.81284141540527

EPOCH 9 ------------------
step: 10	loss: 2219.0551447868347	speed (wps):24840.056339057293
step: 30	loss: 6251.011929512024	speed (wps):25594.106204929765
step: 50	loss: 10237.420942783356	speed (wps):25766.228549396576
step: 70	loss: 14250.568869113922	speed (wps):25842.317005537858
step: 90	loss: 18228.196289539337	speed (wps):25881.88212577725
step: 110	loss: 22191.810438632965	speed (wps):25908.72930350957
step: 130	loss: 26164.15155649185	speed (wps):25927.991464160677
step: 150	loss: 30108.033027648926	speed (wps):25942.025130137434
step: 170	loss: 34028.91285419464	speed (wps):25950.751091950708
step: 190	loss: 37866.3551235199	speed (wps):25959.32779167024
Saving model parameters to best_params.pt
epoch: 9	train ppl: 285.16126413926906	val ppl: 271.3253195966113	best val: 271.3253195966113	time (s) spent in epoch: 36.809234619140625

EPOCH 10 ------------------
step: 10	loss: 2137.9088282585144	speed (wps):24868.977828086365
step: 30	loss: 6054.529044628143	speed (wps):25610.731157971146
step: 50	loss: 9944.418008327484	speed (wps):25774.204190720186
step: 70	loss: 13872.471747398376	speed (wps):25845.929137990657
step: 90	loss: 17757.516791820526	speed (wps):25884.428379398472
step: 110	loss: 21639.049422740936	speed (wps):25912.144407679018
step: 130	loss: 25498.590495586395	speed (wps):25930.492794612524
step: 150	loss: 29378.76136302948	speed (wps):25942.86598918514
step: 170	loss: 33177.45631694794	speed (wps):25955.91971603211
step: 190	loss: 36931.554906368256	speed (wps):25963.911954798346
epoch: 10	train ppl: 249.59406580895165	val ppl: 273.23431326097915	best val: 271.3253195966113	time (s) spent in epoch: 36.60374140739441

EPOCH 11 ------------------
step: 10	loss: 2113.896563053131	speed (wps):24839.593640486837
step: 30	loss: 5957.861461639404	speed (wps):25598.00562773424
step: 50	loss: 9768.095915317535	speed (wps):25768.911262179343
step: 70	loss: 13585.43428659439	speed (wps):25844.63436153114
step: 90	loss: 17346.4772939682	speed (wps):25886.16939783383
step: 110	loss: 21095.066177845	speed (wps):25913.073497520338
step: 130	loss: 24863.20240497589	speed (wps):25932.515679957585
step: 150	loss: 28573.8428068161	speed (wps):25946.029245913214
step: 170	loss: 32247.966718673706	speed (wps):25956.081163873176
step: 190	loss: 35951.787889003754	speed (wps):25965.19960519677
Saving model parameters to best_params.pt
epoch: 11	train ppl: 215.7594082725885	val ppl: 252.56953678838272	best val: 252.56953678838272	time (s) spent in epoch: 36.80398392677307

EPOCH 12 ------------------
step: 10	loss: 2060.0673937797546	speed (wps):24847.434978362286
step: 30	loss: 5799.215040206909	speed (wps):25608.863234618635
step: 50	loss: 9506.054487228394	speed (wps):25775.966441348035
step: 70	loss: 13217.63905286789	speed (wps):25850.431824196847
step: 90	loss: 16947.008621692657	speed (wps):25895.972923819474
step: 110	loss: 20626.79913520813	speed (wps):25921.581662483386
step: 130	loss: 24325.850837230682	speed (wps):25942.02678683301
step: 150	loss: 27976.278445720673	speed (wps):25954.4200952818
step: 170	loss: 31592.759082317352	speed (wps):25964.511530836608
step: 190	loss: 35136.70902013779	speed (wps):25972.969354275752
Saving model parameters to best_params.pt
epoch: 12	train ppl: 189.59551219762713	val ppl: 225.41575286825793	best val: 225.41575286825793	time (s) spent in epoch: 36.795127630233765

EPOCH 13 ------------------
step: 10	loss: 2005.2342128753662	speed (wps):24831.62300630692
step: 30	loss: 5631.379573345184	speed (wps):25594.49080818456
step: 50	loss: 9265.158603191376	speed (wps):25767.727113730154
step: 70	loss: 12896.811165809631	speed (wps):25844.380528455975
step: 90	loss: 16531.079592704773	speed (wps):25885.29200185443
step: 110	loss: 20131.51625394821	speed (wps):25911.148108510104
step: 130	loss: 23731.765694618225	speed (wps):25932.22581840533
step: 150	loss: 27312.25276708603	speed (wps):25945.400993152944
step: 170	loss: 30808.38585615158	speed (wps):25956.179081918865
step: 190	loss: 34295.54287195206	speed (wps):25964.195583816214
epoch: 13	train ppl: 168.32699365567916	val ppl: 228.06817888657216	best val: 225.41575286825793	time (s) spent in epoch: 36.603946685791016

EPOCH 14 ------------------
step: 10	loss: 1978.3003187179565	speed (wps):24895.153864461292
step: 30	loss: 5524.221529960632	speed (wps):25616.3985214648
step: 50	loss: 9075.443363189697	speed (wps):25781.441215253493
step: 70	loss: 12599.533100128174	speed (wps):25856.387233855177
step: 90	loss: 16142.93219089508	speed (wps):25897.20795671758
step: 110	loss: 19637.454645633698	speed (wps):25922.960872594133
step: 130	loss: 23163.439452648163	speed (wps):25939.905649278633
step: 150	loss: 26615.891551971436	speed (wps):25952.923993439992
step: 170	loss: 30094.909012317657	speed (wps):25962.353184488285
step: 190	loss: 33488.53558301926	speed (wps):25970.26184435832
epoch: 14	train ppl: 148.62723648135602	val ppl: 261.6466203533046	best val: 225.41575286825793	time (s) spent in epoch: 36.59811782836914

EPOCH 15 ------------------
step: 10	loss: 1943.2479310035706	speed (wps):24846.774873004488
step: 30	loss: 5462.881875038147	speed (wps):25611.637632475897
step: 50	loss: 8913.692481517792	speed (wps):25779.22883536795
step: 70	loss: 12320.122916698456	speed (wps):25846.893545356805
step: 90	loss: 15777.877173423767	speed (wps):25890.09156377493
step: 110	loss: 19174.416377544403	speed (wps):25918.56440715313
step: 130	loss: 22635.155415534973	speed (wps):25940.430228793663
step: 150	loss: 26045.599377155304	speed (wps):25953.565904934665
step: 170	loss: 29404.74069595337	speed (wps):25962.084045737356
step: 190	loss: 32683.749089241028	speed (wps):25969.627241799128
Saving model parameters to best_params.pt
epoch: 15	train ppl: 131.35436331157896	val ppl: 203.26170009405948	best val: 203.26170009405948	time (s) spent in epoch: 36.80108690261841

EPOCH 16 ------------------
step: 10	loss: 1886.1331057548523	speed (wps):24857.538068856105
step: 30	loss: 5332.546098232269	speed (wps):25613.41811266194
step: 50	loss: 8737.82612323761	speed (wps):25780.33913906276
step: 70	loss: 12128.909027576447	speed (wps):25852.03175473318
step: 90	loss: 15513.041038513184	speed (wps):25892.853117714752
step: 110	loss: 18822.411274909973	speed (wps):25919.691084783994
step: 130	loss: 22160.570137500763	speed (wps):25939.453254072898
step: 150	loss: 25509.200468063354	speed (wps):25951.66067902029
step: 170	loss: 28822.887592315674	speed (wps):25960.981746886413
step: 190	loss: 32068.77892255783	speed (wps):25968.60934919474
Saving model parameters to best_params.pt
epoch: 16	train ppl: 119.50547248366613	val ppl: 190.85787439701485	best val: 190.85787439701485	time (s) spent in epoch: 36.85182523727417

EPOCH 17 ------------------
step: 10	loss: 1858.6778712272644	speed (wps):24848.41474690166
step: 30	loss: 5216.317887306213	speed (wps):25602.689429616035
step: 50	loss: 8481.051955223083	speed (wps):25768.911262179343
step: 70	loss: 11785.365884304047	speed (wps):25846.102385516497
step: 90	loss: 15098.605318069458	speed (wps):25886.09533218557
step: 110	loss: 18333.674821853638	speed (wps):25910.899287104243
step: 130	loss: 21580.220205783844	speed (wps):25929.5608164432
step: 150	loss: 24816.807951927185	speed (wps):25944.281222288853
step: 170	loss: 28047.313899993896	speed (wps):25955.571037482776
step: 190	loss: 31205.5668258667	speed (wps):25963.21154915402
epoch: 17	train ppl: 106.20057940635972	val ppl: 198.37645178972977	best val: 190.85787439701485	time (s) spent in epoch: 36.605342388153076

EPOCH 18 ------------------
step: 10	loss: 1805.8783149719238	speed (wps):24883.312563059924
step: 30	loss: 5105.268616676331	speed (wps):25614.075860554196
step: 50	loss: 8269.777059555054	speed (wps):25784.168027671374
step: 70	loss: 11480.17029762268	speed (wps):25858.2114296143
step: 90	loss: 14732.868542671204	speed (wps):25896.14391531494
step: 110	loss: 17898.984265327454	speed (wps):25918.782133673856
step: 130	loss: 21116.54315471649	speed (wps):25936.95566056439
step: 150	loss: 24313.384013175964	speed (wps):25949.434155350566
step: 170	loss: 27471.315820217133	speed (wps):25958.61993316624
step: 190	loss: 30570.238716602325	speed (wps):25965.85071089161
Saving model parameters to best_params.pt
epoch: 18	train ppl: 96.10499621344273	val ppl: 182.51584633074623	best val: 182.51584633074623	time (s) spent in epoch: 36.80552816390991

EPOCH 19 ------------------
step: 10	loss: 1743.8760113716125	speed (wps):24888.927609624854
step: 30	loss: 4952.085738182068	speed (wps):25619.819074152012
step: 50	loss: 8087.191255092621	speed (wps):25785.886541780168
step: 70	loss: 11221.210615634918	speed (wps):25859.51608789936
step: 90	loss: 14407.318217754364	speed (wps):25898.230114948365
step: 110	loss: 17509.16546344757	speed (wps):25923.43804065203
step: 130	loss: 20656.963410377502	speed (wps):25940.505131403817
step: 150	loss: 23715.031883716583	speed (wps):25951.36279021475
step: 170	loss: 26770.027055740356	speed (wps):25963.61902956981
step: 190	loss: 29747.469551563263	speed (wps):25973.140213590596
epoch: 19	train ppl: 85.3961776602063	val ppl: 191.90844077356763	best val: 182.51584633074623	time (s) spent in epoch: 36.59105396270752

EPOCH 20 ------------------
step: 10	loss: 1709.5338869094849	speed (wps):24870.201683030195
step: 30	loss: 4830.635311603546	speed (wps):25627.096983551284
step: 50	loss: 7862.1104526519775	speed (wps):25789.920434071424
step: 70	loss: 10972.486531734467	speed (wps):25865.030888482484
step: 90	loss: 14059.878089427948	speed (wps):25908.86675899873
step: 110	loss: 17047.67130613327	speed (wps):25937.588366931388
step: 130	loss: 20170.40395975113	speed (wps):25956.35292800427
step: 150	loss: 23177.647488117218	speed (wps):25970.922600619197
step: 170	loss: 26147.796976566315	speed (wps):25981.60215018768
step: 190	loss: 29038.70708465576	speed (wps):25990.06133866199
epoch: 20	train ppl: 76.53622369121156	val ppl: 209.85462163940514	best val: 182.51584633074623	time (s) spent in epoch: 36.568634033203125

EPOCH 21 ------------------
step: 10	loss: 1673.5799598693848	speed (wps):24890.12045912057
step: 30	loss: 4787.367265224457	speed (wps):25636.814819352872
step: 50	loss: 7750.005917549133	speed (wps):25799.694999100135
step: 70	loss: 10717.863631248474	speed (wps):25870.858075273736
step: 90	loss: 13676.472259759903	speed (wps):25912.335582636322
step: 110	loss: 16620.944875478745	speed (wps):25939.244126513517
step: 130	loss: 19705.288132429123	speed (wps):25955.624627156263
step: 150	loss: 22629.8040163517	speed (wps):25967.343078917635
step: 170	loss: 25555.08558869362	speed (wps):25976.815584522217
step: 190	loss: 28433.80210995674	speed (wps):25984.236031005017
epoch: 21	train ppl: 69.41899891522255	val ppl: 184.00886579644327	best val: 182.51584633074623	time (s) spent in epoch: 36.57609963417053

EPOCH 22 ------------------
step: 10	loss: 1588.30739736557	speed (wps):24887.48615263468
step: 30	loss: 4695.0950264930725	speed (wps):25633.3615270049
step: 50	loss: 7591.333227157593	speed (wps):25796.62810708633
step: 70	loss: 10538.109475374222	speed (wps):25869.579360247084
step: 90	loss: 13542.421878576279	speed (wps):25907.297750227775
step: 110	loss: 16434.850679636	speed (wps):25932.87481936296
step: 130	loss: 19381.289294958115	speed (wps):25952.01355940509
step: 150	loss: 22270.121426582336	speed (wps):25964.404378091236
step: 170	loss: 25064.994523525238	speed (wps):25974.378029438813
step: 190	loss: 27839.090309143066	speed (wps):25982.274213993544
epoch: 22	train ppl: 63.35050429994606	val ppl: 215.91581771526816	best val: 182.51584633074623	time (s) spent in epoch: 36.58142399787903

EPOCH 23 ------------------
step: 10	loss: 1567.2846364974976	speed (wps):24551.471259277983
step: 30	loss: 4618.364365100861	speed (wps):25495.85692643026
step: 50	loss: 7447.417833805084	speed (wps):25712.760341293266
step: 70	loss: 10259.198093414307	speed (wps):25802.37860927452
step: 90	loss: 13104.380110502243	speed (wps):25853.794564121654
step: 110	loss: 15874.50914144516	speed (wps):25890.7766806636
step: 130	loss: 18821.304916143417	speed (wps):25914.959745034725
step: 150	loss: 21641.103266477585	speed (wps):25932.665508196565
step: 170	loss: 24379.305473566055	speed (wps):25945.575098235433
step: 190	loss: 27016.402512788773	speed (wps):25957.716113424372
epoch: 23	train ppl: 55.94322509923073	val ppl: 201.09203807678497	best val: 182.51584633074623	time (s) spent in epoch: 36.611984968185425

EPOCH 24 ------------------
step: 10	loss: 1515.197137594223	speed (wps):24887.635984462635
step: 30	loss: 4529.718219041824	speed (wps):25639.233016220893
step: 50	loss: 7298.711860179901	speed (wps):25800.299296149573
step: 70	loss: 10027.92475104332	speed (wps):25875.156166368746
step: 90	loss: 12790.512696504593	speed (wps):25914.04815367995
step: 110	loss: 15507.294011116028	speed (wps):25939.350582345367
step: 130	loss: 18379.46759223938	speed (wps):25954.144066356486
step: 150	loss: 21200.243426561356	speed (wps):25963.128542222577
step: 170	loss: 23912.798451185226	speed (wps):25973.322345528843
step: 190	loss: 26480.36394238472	speed (wps):25981.675325337954
epoch: 24	train ppl: 51.48708037687584	val ppl: 240.01270277857273	best val: 182.51584633074623	time (s) spent in epoch: 36.578224897384644

EPOCH 25 ------------------
step: 10	loss: 1456.9058668613434	speed (wps):24867.320280199834
step: 30	loss: 4344.944764375687	speed (wps):25624.970779862648
step: 50	loss: 7030.172978639603	speed (wps):25786.18211876693
step: 70	loss: 9755.328975915909	speed (wps):25863.797374347818
step: 90	loss: 12510.220183134079	speed (wps):25901.564260820665
step: 110	loss: 15118.335417509079	speed (wps):25925.734234683674
step: 130	loss: 17840.688021183014	speed (wps):25945.82268169539
step: 150	loss: 20496.514486074448	speed (wps):25958.44228785456
step: 170	loss: 23117.525309324265	speed (wps):25969.726987384933
step: 190	loss: 25721.99122786522	speed (wps):25976.349929370248
epoch: 25	train ppl: 46.178591320321	val ppl: 236.5066292632929	best val: 182.51584633074623	time (s) spent in epoch: 36.58840465545654

EPOCH 26 ------------------
step: 10	loss: 1415.0331628322601	speed (wps):24868.466178718703
step: 30	loss: 4220.374264717102	speed (wps):25614.788834350984
step: 50	loss: 6854.105046987534	speed (wps):25786.199465044734
step: 70	loss: 9551.284819841385	speed (wps):25858.72265151975
step: 90	loss: 12154.104388952255	speed (wps):25899.782726042737
step: 110	loss: 14648.727806806564	speed (wps):25926.045860139202
step: 130	loss: 17418.385890722275	speed (wps):25945.20271719829
step: 150	loss: 20073.417661190033	speed (wps):25958.245411469525
step: 170	loss: 22626.726100444794	speed (wps):25969.0213417694
step: 190	loss: 25140.69547176361	speed (wps):25976.65037560405
epoch: 26	train ppl: 42.10505736143203	val ppl: 254.29854521384985	best val: 182.51584633074623	time (s) spent in epoch: 36.586127042770386

EPOCH 27 ------------------
step: 10	loss: 1376.8635475635529	speed (wps):24885.0890887179
step: 30	loss: 4205.119317770004	speed (wps):25620.382493892834
step: 50	loss: 6727.919390201569	speed (wps):25786.44370311378
step: 70	loss: 9249.148281812668	speed (wps):25859.059467585565
step: 90	loss: 11781.94210767746	speed (wps):25899.755265411874
step: 110	loss: 14257.684777975082	speed (wps):25924.992099984232
step: 130	loss: 16885.062527656555	speed (wps):25943.726899765206
step: 150	loss: 19503.56667637825	speed (wps):25961.11834543067
step: 170	loss: 21996.479048728943	speed (wps):25971.827150137906
step: 190	loss: 24409.7221159935	speed (wps):25979.75113098081
epoch: 27	train ppl: 37.661419153486676	val ppl: 260.93873964011635	best val: 182.51584633074623	time (s) spent in epoch: 36.578497648239136

EPOCH 28 ------------------
step: 10	loss: 1310.2126562595367	speed (wps):24889.586959534776
step: 30	loss: 4071.785708665848	speed (wps):25621.45756750933
step: 50	loss: 6558.395792245865	speed (wps):25797.175316072506
step: 70	loss: 9092.890090942383	speed (wps):25866.766531784233
step: 90	loss: 11550.657016038895	speed (wps):25909.489783167213
step: 110	loss: 13921.186805963516	speed (wps):25938.817989342413
step: 130	loss: 16459.25334095955	speed (wps):25955.794314043866
step: 150	loss: 18945.708431005478	speed (wps):25970.083011996554
step: 170	loss: 21403.40541124344	speed (wps):25979.717812337294
step: 190	loss: 23779.764924049377	speed (wps):25986.480567007715
epoch: 28	train ppl: 34.310028699370996	val ppl: 308.3159646362672	best val: 182.51584633074623	time (s) spent in epoch: 36.5737669467926

EPOCH 29 ------------------
step: 10	loss: 1286.1070227622986	speed (wps):24882.117370664822
step: 30	loss: 3970.8746790885925	speed (wps):25624.82649038226
step: 50	loss: 6354.6512842178345	speed (wps):25790.213327274174
step: 70	loss: 8743.946957588196	speed (wps):25863.869576811303
step: 90	loss: 11144.8712515831	speed (wps):25903.40254687258
step: 110	loss: 13466.480078697205	speed (wps):25929.1360948052
step: 130	loss: 15886.623612642288	speed (wps):25947.816231064433
step: 150	loss: 18433.027271032333	speed (wps):25960.092699625864
step: 170	loss: 20907.59488940239	speed (wps):25969.950106991182
step: 190	loss: 23174.556262493134	speed (wps):25978.891532699294
epoch: 29	train ppl: 31.172559862378048	val ppl: 337.9226917801544	best val: 182.51584633074623	time (s) spent in epoch: 36.58338737487793

EPOCH 30 ------------------
step: 10	loss: 1231.4244294166565	speed (wps):24877.451528186662
step: 30	loss: 3884.556665420532	speed (wps):25617.35722061639
step: 50	loss: 6202.713694572449	speed (wps):25788.16182663628
step: 70	loss: 8633.839163780212	speed (wps):25863.399265226042
step: 90	loss: 11032.949614524841	speed (wps):25904.48602186069
step: 110	loss: 13270.821954011917	speed (wps):25935.180102808456
step: 130	loss: 15783.404285907745	speed (wps):25951.188923286958
step: 150	loss: 18163.938109874725	speed (wps):25965.686042257636
step: 170	loss: 20466.111562252045	speed (wps):25975.601159570106
step: 190	loss: 22684.2289352417	speed (wps):25986.093907218827
epoch: 30	train ppl: 28.955638067673707	val ppl: 392.7455925370352	best val: 182.51584633074623	time (s) spent in epoch: 36.57186436653137

EPOCH 31 ------------------
step: 10	loss: 1303.1775152683258	speed (wps):24913.094608151023
step: 30	loss: 3898.0153596401215	speed (wps):25647.880418575143
step: 50	loss: 6124.324325323105	speed (wps):25810.98266111735
step: 70	loss: 8378.031022548676	speed (wps):25882.359648463367
step: 90	loss: 10654.796316623688	speed (wps):25923.300972222034
step: 110	loss: 12844.386910200119	speed (wps):25949.449147368672
step: 130	loss: 15195.100976228714	speed (wps):25966.78763443852
step: 150	loss: 17605.372346639633	speed (wps):25980.883425724143
step: 170	loss: 19826.82225584984	speed (wps):25990.779020757363
step: 190	loss: 21948.064839839935	speed (wps):25998.78009201803
epoch: 31	train ppl: 26.097616604305138	val ppl: 365.44327410630535	best val: 182.51584633074623	time (s) spent in epoch: 36.557037115097046

EPOCH 32 ------------------
step: 10	loss: 1224.3284225463867	speed (wps):24898.467609633746
step: 30	loss: 3617.882137298584	speed (wps):25640.343531031398
step: 50	loss: 5788.189353942871	speed (wps):25805.956055465453
step: 70	loss: 8135.146833658218	speed (wps):25880.04104494962
step: 90	loss: 10333.859965801239	speed (wps):25738.546174382325
step: 110	loss: 12408.82523059845	speed (wps):25795.89783058636
step: 130	loss: 14797.026377916336	speed (wps):25834.140104307433
step: 150	loss: 17146.50336623192	speed (wps):25864.883970398387
step: 170	loss: 19357.24720597267	speed (wps):25888.90530202356
step: 190	loss: 21400.782854557037	speed (wps):25907.739822737043
epoch: 32	train ppl: 23.977428971922564	val ppl: 388.01216108276395	best val: 182.51584633074623	time (s) spent in epoch: 36.67050290107727

EPOCH 33 ------------------
step: 10	loss: 1164.1951704025269	speed (wps):24898.60257722657
step: 30	loss: 3603.7966096401215	speed (wps):25631.87151734024
step: 50	loss: 5806.594272851944	speed (wps):25804.516271502034
step: 70	loss: 7951.87663435936	speed (wps):25878.614341256125
step: 90	loss: 10081.367871761322	speed (wps):25920.40757794693
step: 110	loss: 12162.189428806305	speed (wps):25945.897359215032
step: 130	loss: 14456.035362482071	speed (wps):25965.403031529073
step: 150	loss: 16670.77309370041	speed (wps):25979.54412233074
step: 170	loss: 18770.972814559937	speed (wps):25989.75416661834
step: 190	loss: 20734.365832805634	speed (wps):25998.191930217927
epoch: 33	train ppl: 21.848108342326782	val ppl: 512.3956541248762	best val: 182.51584633074623	time (s) spent in epoch: 36.5559618473053

EPOCH 34 ------------------
step: 10	loss: 1165.8430886268616	speed (wps):24883.636093529447
step: 30	loss: 3413.840901851654	speed (wps):25624.65289425471
step: 50	loss: 5507.986378669739	speed (wps):25789.817714808247
step: 70	loss: 7740.1409304142	speed (wps):25864.097719188965
step: 90	loss: 9783.0111682415	speed (wps):25904.908684088507
step: 110	loss: 11741.603116989136	speed (wps):25931.953981408133
step: 130	loss: 14001.826877593994	speed (wps):25951.91205027277
step: 150	loss: 16092.767516374588	speed (wps):25965.614993786436
step: 170	loss: 18168.00036907196	speed (wps):25975.58058063407
step: 190	loss: 20117.560769319534	speed (wps):25984.986298806234
epoch: 34	train ppl: 19.837780620040895	val ppl: 517.0972822059995	best val: 182.51584633074623	time (s) spent in epoch: 36.57986354827881

EPOCH 35 ------------------
step: 10	loss: 1195.6840586662292	speed (wps):24865.929187634363
step: 30	loss: 3505.0894105434418	speed (wps):25613.299856777798
step: 50	loss: 5527.015327215195	speed (wps):25795.56569907894
step: 70	loss: 7695.199389457703	speed (wps):25866.967141230263
step: 90	loss: 9677.111414670944	speed (wps):25908.968042551747
step: 110	loss: 11592.980765104294	speed (wps):25936.33660720994
step: 130	loss: 13813.338893651962	speed (wps):25955.713575651305
step: 150	loss: 15826.001363992691	speed (wps):25968.436796192724
step: 170	loss: 17805.824414491653	speed (wps):25979.73545704267
step: 190	loss: 19668.353984355927	speed (wps):25987.958823600246
epoch: 35	train ppl: 18.61399984752879	val ppl: 513.626610604271	best val: 182.51584633074623	time (s) spent in epoch: 36.57180738449097

EPOCH 36 ------------------
step: 10	loss: 1089.9584829807281	speed (wps):24869.118460548525
step: 30	loss: 3189.9674785137177	speed (wps):25613.981250900604
step: 50	loss: 5163.428283929825	speed (wps):25782.496217230222
step: 70	loss: 7389.78734254837	speed (wps):25858.299137818434
step: 90	loss: 9290.981557369232	speed (wps):25901.888345242933
step: 110	loss: 11105.62861442566	speed (wps):25929.65958673383
step: 130	loss: 13149.033677577972	speed (wps):25948.832405437945
step: 150	loss: 15263.314019441605	speed (wps):25966.59663769069
step: 170	loss: 17169.980889558792	speed (wps):25974.71356508891
step: 190	loss: 18986.268362998962	speed (wps):25982.542631908054
epoch: 36	train ppl: 16.77247226723956	val ppl: 575.8642097923466	best val: 182.51584633074623	time (s) spent in epoch: 36.57709455490112

EPOCH 37 ------------------
step: 10	loss: 1105.2490532398224	speed (wps):24890.537084251144
step: 30	loss: 3323.6228489875793	speed (wps):25625.81287666601
step: 50	loss: 5199.281132221222	speed (wps):25797.24198271307
step: 70	loss: 7360.146685838699	speed (wps):25874.10032735447
step: 90	loss: 9297.193557024002	speed (wps):25913.61930244688
step: 110	loss: 11076.363583803177	speed (wps):25939.235739121475
step: 130	loss: 13134.86424446106	speed (wps):25955.169767767136
step: 150	loss: 15098.146579265594	speed (wps):25968.92117934533
step: 170	loss: 16926.36352300644	speed (wps):25979.02443640427
step: 190	loss: 18772.778087854385	speed (wps):25985.739620297718
epoch: 37	train ppl: 16.336842017763335	val ppl: 626.2498915928458	best val: 182.51584633074623	time (s) spent in epoch: 36.57296276092529

EPOCH 38 ------------------
step: 10	loss: 1025.1292288303375	speed (wps):24865.33689868907
step: 30	loss: 3052.3537397384644	speed (wps):25614.720125827233
step: 50	loss: 4952.3034834861755	speed (wps):25787.068196487744
step: 70	loss: 6900.123556852341	speed (wps):25864.16139920848
step: 90	loss: 8754.543319940567	speed (wps):25910.06965047661
step: 110	loss: 10545.07243514061	speed (wps):25937.829959823503
step: 130	loss: 12664.077801704407	speed (wps):25956.07922879199
step: 150	loss: 14513.208183050156	speed (wps):25967.603547337967
step: 170	loss: 16363.88147354126	speed (wps):25978.428973437945
step: 190	loss: 18131.142441034317	speed (wps):25986.566743847423
epoch: 38	train ppl: 14.72590681948404	val ppl: 666.0637130159425	best val: 182.51584633074623	time (s) spent in epoch: 36.57277870178223

EPOCH 39 ------------------
step: 10	loss: 1013.3361184597015	speed (wps):24884.307146509298
step: 30	loss: 3069.437984228134	speed (wps):25629.17054103842
step: 50	loss: 4827.695090770721	speed (wps):25791.253082462692
step: 70	loss: 6789.907925128937	speed (wps):25822.07122271917
step: 90	loss: 8546.025780439377	speed (wps):25874.14183379285
step: 110	loss: 10256.462366580963	speed (wps):25905.230801515496
step: 130	loss: 12364.578565359116	speed (wps):25929.30598179074
step: 150	loss: 14180.343405008316	speed (wps):25945.436343425667
step: 170	loss: 15887.526278495789	speed (wps):25956.214517111024
step: 190	loss: 17644.75593328476	speed (wps):25964.959722495772
epoch: 39	train ppl: 13.702512642419443	val ppl: 682.1732951795168	best val: 182.51584633074623	time (s) spent in epoch: 36.601073026657104

DONE

Saving learning curves to TRANSFORMER_SDG_LR_SCHEDULE_model=TRANSFORMER_optimizer=SDG_LR_SCHEDULE_initial_lr=20_batch_size=128_seq_len=35_hidden_size=512_num_layers=6_dp_keep_prob=0.9_save_best_0/learning_curves.npy
