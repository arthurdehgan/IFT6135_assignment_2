Using the GPU

########## Setting Up Experiment ######################

Putting log in TRANSFORMER_ADAM_model=TRANSFORMER_optimizer=ADAM_initial_lr=0.001_batch_size=128_seq_len=35_hidden_size=512_num_layers=2_dp_keep_prob=.9_0
Using the GPU
Loading data from data
  vocabulary size: 10000

########## Running Main Loop ##########################

EPOCH 0 ------------------
step: 10	loss: 2869.801080226898	speed (wps):33236.68176850181
step: 30	loss: 7488.3679032325745	speed (wps):43172.2651802588
step: 50	loss: 11905.726165771484	speed (wps):46142.022624991914
step: 70	loss: 16103.953177928925	speed (wps):47583.08855896977
step: 90	loss: 20126.932904720306	speed (wps):48418.17520751955
step: 110	loss: 24027.127244472504	speed (wps):48973.3283042231
step: 130	loss: 27838.488926887512	speed (wps):49355.62537059781
step: 150	loss: 31586.815705299377	speed (wps):49649.11939497763
step: 170	loss: 35257.09275007248	speed (wps):49876.786396093696
step: 190	loss: 38904.779925346375	speed (wps):50064.160237584016
epoch: 0	train ppl: 320.6997787482786	val ppl: 176.96281389999794	best val: 176.96281389999794	time (s) spent in epoch: 18.988831996917725

EPOCH 1 ------------------
step: 10	loss: 1984.1237664222717	speed (wps):47241.07692905449
step: 30	loss: 5545.14315366745	speed (wps):50014.698574485854
step: 50	loss: 9043.433101177216	speed (wps):50643.26901424215
step: 70	loss: 12507.930386066437	speed (wps):50932.27803334654
step: 90	loss: 15920.77353477478	speed (wps):51094.48179525822
step: 110	loss: 19292.057704925537	speed (wps):51200.132722351766
step: 130	loss: 22630.19024848938	speed (wps):49533.552145298825
step: 150	loss: 25925.99860906601	speed (wps):49807.40270383983
step: 170	loss: 29175.690460205078	speed (wps):50020.616764855986
step: 190	loss: 32410.096747875214	speed (wps):50189.85111271904
epoch: 1	train ppl: 125.3785106288597	val ppl: 140.26078494171105	best val: 140.26078494171105	time (s) spent in epoch: 18.87936234474182

EPOCH 2 ------------------
step: 10	loss: 1782.527096271515	speed (wps):47330.56009789657
step: 30	loss: 4999.702715873718	speed (wps):50068.96044912293
step: 50	loss: 8161.500883102417	speed (wps):50654.11036391753
step: 70	loss: 11312.236280441284	speed (wps):50926.19078396587
step: 90	loss: 14431.144714355469	speed (wps):51114.167692103365
step: 110	loss: 17516.67439699173	speed (wps):51217.27929722233
step: 130	loss: 20585.16951084137	speed (wps):51288.9368498567
step: 150	loss: 23611.974334716797	speed (wps):51339.67235254877
step: 170	loss: 26606.031045913696	speed (wps):51388.59648144703
step: 190	loss: 29585.12459754944	speed (wps):51422.719994094594
epoch: 2	train ppl: 82.56207460536521	val ppl: 135.13459863464527	best val: 135.13459863464527	time (s) spent in epoch: 18.46755027770996

EPOCH 3 ------------------
step: 10	loss: 1647.3866367340088	speed (wps):46225.616354444704
step: 30	loss: 4630.653114318848	speed (wps):49635.325286712934
step: 50	loss: 7550.519943237305	speed (wps):50438.626100726135
step: 70	loss: 10479.015407562256	speed (wps):47881.760159122045
step: 90	loss: 13373.002179861069	speed (wps):48676.20660586726
step: 110	loss: 16239.132214784622	speed (wps):49212.91981311608
step: 130	loss: 19091.956120729446	speed (wps):49586.85126342616
step: 150	loss: 21908.191430568695	speed (wps):49861.040793206885
step: 170	loss: 24697.08011984825	speed (wps):50075.22425998073
step: 190	loss: 27474.79527235031	speed (wps):48905.9790416187
epoch: 3	train ppl: 60.29871331946401	val ppl: 139.3127595096412	best val: 135.13459863464527	time (s) spent in epoch: 19.32418441772461

EPOCH 4 ------------------
step: 10	loss: 1533.4175729751587	speed (wps):47372.26927037483
step: 30	loss: 4323.806930780411	speed (wps):50098.39322871559
step: 50	loss: 7044.674128293991	speed (wps):50726.34908280555
step: 70	loss: 9780.764204263687	speed (wps):51006.922697068345
step: 90	loss: 12482.994701862335	speed (wps):51167.23423757812
step: 110	loss: 15155.66870689392	speed (wps):51262.16515545111
step: 130	loss: 17822.36447930336	speed (wps):51336.564040246165
step: 150	loss: 20453.309174776077	speed (wps):47920.10552492255
step: 170	loss: 23063.016768693924	speed (wps):48339.11338095676
step: 190	loss: 25658.788154125214	speed (wps):48676.29644851001
epoch: 4	train ppl: 45.99605491183587	val ppl: 152.02399563765985	best val: 135.13459863464527	time (s) spent in epoch: 19.40652894973755

EPOCH 5 ------------------
step: 10	loss: 1430.628855228424	speed (wps):47440.88830090739
step: 30	loss: 4051.76455616951	speed (wps):50133.78416233397
step: 50	loss: 6603.847341537476	speed (wps):50785.95019660907
step: 70	loss: 9162.575330734253	speed (wps):51054.5520795388
step: 90	loss: 11686.578351259232	speed (wps):51204.56372847607
step: 110	loss: 14187.326174974442	speed (wps):51298.614504398625
step: 130	loss: 16686.60701751709	speed (wps):47034.82868733585
step: 150	loss: 19146.783952713013	speed (wps):47607.643738203114
step: 170	loss: 21591.37722849846	speed (wps):48058.75136063807
step: 190	loss: 24016.95064306259	speed (wps):48429.98221845648
epoch: 5	train ppl: 35.995744490187434	val ppl: 169.93975390781986	best val: 135.13459863464527	time (s) spent in epoch: 19.49628186225891

EPOCH 6 ------------------
step: 10	loss: 1337.0766973495483	speed (wps):47362.109112223254
step: 30	loss: 3801.025322675705	speed (wps):50117.48380874848
step: 50	loss: 6198.475863933563	speed (wps):50742.838218799385
step: 70	loss: 8594.829767942429	speed (wps):51019.184116292716
step: 90	loss: 10963.257590532303	speed (wps):51178.740005505366
step: 110	loss: 13303.736642599106	speed (wps):49225.16163332558
step: 130	loss: 15644.09827709198	speed (wps):49593.1641427988
step: 150	loss: 17950.113306045532	speed (wps):49869.2162892004
step: 170	loss: 20240.576877593994	speed (wps):50083.55240768474
step: 190	loss: 22518.076918125153	speed (wps):50253.948892444474
epoch: 6	train ppl: 28.79824754647652	val ppl: 194.33508487169468	best val: 135.13459863464527	time (s) spent in epoch: 18.855132818222046

EPOCH 7 ------------------
step: 10	loss: 1252.6691830158234	speed (wps):47419.77367383355
step: 30	loss: 3558.439213037491	speed (wps):50117.92794884074
step: 50	loss: 5804.000062942505	speed (wps):50746.51676611237
step: 70	loss: 8057.671854496002	speed (wps):51025.9025024039
step: 90	loss: 10290.103231668472	speed (wps):51184.04055561198
step: 110	loss: 12489.281561374664	speed (wps):51284.35766077097
step: 130	loss: 14688.860768079758	speed (wps):51348.72299160319
step: 150	loss: 16855.821129083633	speed (wps):51401.406336582724
step: 170	loss: 19006.44670367241	speed (wps):51442.205770814166
step: 190	loss: 21144.87593770027	speed (wps):51484.08895881107
epoch: 7	train ppl: 23.471145301352106	val ppl: 224.0970562518604	best val: 135.13459863464527	time (s) spent in epoch: 18.80382490158081

EPOCH 8 ------------------
step: 10	loss: 1175.4015100002289	speed (wps):47524.91231603797
step: 30	loss: 3336.511219739914	speed (wps):50166.90491251698
step: 50	loss: 5441.536267995834	speed (wps):50873.12346405505
step: 70	loss: 7555.145416259766	speed (wps):51119.24696941668
step: 90	loss: 9654.482609033585	speed (wps):51258.86770656647
step: 110	loss: 11719.301413297653	speed (wps):51351.522192876255
step: 130	loss: 13792.952646017075	speed (wps):48866.85890829367
step: 150	loss: 15834.552018642426	speed (wps):49230.239005241165
step: 170	loss: 17859.929240942	speed (wps):49512.27491549195
step: 190	loss: 19872.643214464188	speed (wps):49734.22676055124
epoch: 8	train ppl: 19.424751337293475	val ppl: 258.84151720008464	best val: 135.13459863464527	time (s) spent in epoch: 19.032647132873535

EPOCH 9 ------------------
step: 10	loss: 1106.0857963562012	speed (wps):47428.8920157026
step: 30	loss: 3143.598117828369	speed (wps):50127.23514112268
step: 50	loss: 5113.439990282059	speed (wps):50756.42113089603
step: 70	loss: 7103.760226964951	speed (wps):51040.52398357995
step: 90	loss: 9077.326850891113	speed (wps):51195.121638326425
step: 110	loss: 11029.65592265129	speed (wps):50025.387363558526
step: 130	loss: 12979.800248146057	speed (wps):50281.66277696065
step: 150	loss: 14906.338192224503	speed (wps):50473.12854856597
step: 170	loss: 16822.835644483566	speed (wps):50618.939820901745
step: 190	loss: 18724.073927402496	speed (wps):50735.12505868001
epoch: 9	train ppl: 16.377599130836263	val ppl: 296.30158052844587	best val: 135.13459863464527	time (s) spent in epoch: 18.693142652511597

EPOCH 10 ------------------
step: 10	loss: 1041.8263483047485	speed (wps):46419.966995484116
step: 30	loss: 2958.765791654587	speed (wps):49738.678997997406
step: 50	loss: 4815.84899187088	speed (wps):50506.449655090415
step: 70	loss: 6699.2076098918915	speed (wps):50852.98768820476
step: 90	loss: 8562.365732192993	speed (wps):51048.86349549209
step: 110	loss: 10402.86381483078	speed (wps):51175.17266862594
step: 130	loss: 12251.008092164993	speed (wps):51264.57343974281
step: 150	loss: 14070.23118019104	speed (wps):50535.25199635922
step: 170	loss: 15881.30779504776	speed (wps):50674.80069998442
step: 190	loss: 17677.761929035187	speed (wps):50790.41038743668
epoch: 10	train ppl: 14.01854431600964	val ppl: 342.29963356886384	best val: 135.13459863464527	time (s) spent in epoch: 18.9458646774292

EPOCH 11 ------------------
step: 10	loss: 985.8411133289337	speed (wps):47464.626595078495
step: 30	loss: 2800.6904780864716	speed (wps):50159.51792849578
step: 50	loss: 4556.061053276062	speed (wps):50784.281580275965
step: 70	loss: 6338.587290048599	speed (wps):51053.9171133022
step: 90	loss: 8098.585232496262	speed (wps):51211.80671041981
step: 110	loss: 9841.785836219788	speed (wps):51300.843995780415
step: 130	loss: 11590.631420612335	speed (wps):50333.75438803123
step: 150	loss: 13320.18837094307	speed (wps):50517.43428814982
step: 170	loss: 15034.862045049667	speed (wps):50658.04722523965
step: 190	loss: 16738.24782729149	speed (wps):50771.099970932024
epoch: 11	train ppl: 12.188876638345866	val ppl: 394.74246930180436	best val: 135.13459863464527	time (s) spent in epoch: 18.680607795715332

EPOCH 12 ------------------
step: 10	loss: 934.996474981308	speed (wps):47442.43454310083
step: 30	loss: 2653.1087458133698	speed (wps):50142.52748561933
step: 50	loss: 4311.654967069626	speed (wps):50769.11565709907
step: 70	loss: 6005.288039445877	speed (wps):50962.84124620126
step: 90	loss: 7678.799806833267	speed (wps):51139.14625844206
step: 110	loss: 9335.569994449615	speed (wps):50309.25042854353
step: 130	loss: 11002.260177135468	speed (wps):50521.10697186079
step: 150	loss: 12646.427364349365	speed (wps):50677.94056821658
step: 170	loss: 14283.504068851471	speed (wps):50786.784781991446
step: 190	loss: 15900.948439836502	speed (wps):50883.99721501941
epoch: 12	train ppl: 10.76565008517414	val ppl: 456.9109992601382	best val: 135.13459863464527	time (s) spent in epoch: 18.644591808319092

EPOCH 13 ------------------
step: 10	loss: 891.5471160411835	speed (wps):46210.14560886325
step: 30	loss: 2528.597801923752	speed (wps):49626.94819433561
step: 50	loss: 4110.463696718216	speed (wps):50427.725530006646
step: 70	loss: 5717.3135578632355	speed (wps):50782.19630515888
step: 90	loss: 7317.794815301895	speed (wps):50987.461212844806
step: 110	loss: 8897.88712143898	speed (wps):51121.71034768901
step: 130	loss: 10485.155593156815	speed (wps):51214.52859838484
step: 150	loss: 12054.011927843094	speed (wps):51281.53503657955
step: 170	loss: 13620.139536857605	speed (wps):51336.17897506276
step: 190	loss: 15162.527784109116	speed (wps):51377.37867924318
epoch: 13	train ppl: 9.641867569940842	val ppl: 526.5789124221126	best val: 135.13459863464527	time (s) spent in epoch: 18.578521013259888

EPOCH 14 ------------------
step: 10	loss: 850.3137040138245	speed (wps):47425.485828589335
step: 30	loss: 2412.5550258159637	speed (wps):50112.49531957564
step: 50	loss: 3919.1365373134613	speed (wps):50741.67484479627
step: 70	loss: 5453.178915977478	speed (wps):51014.109912476124
step: 90	loss: 6975.866295099258	speed (wps):51171.26595097741
step: 110	loss: 8492.205957174301	speed (wps):51274.37388699292
step: 130	loss: 10012.86086320877	speed (wps):51346.248755534805
step: 150	loss: 11505.340408086777	speed (wps):51397.75077129338
step: 170	loss: 12999.788113832474	speed (wps):51438.01080274738
step: 190	loss: 14478.247820138931	speed (wps):51469.72169440835
epoch: 14	train ppl: 8.711990940273553	val ppl: 605.420746191909	best val: 135.13459863464527	time (s) spent in epoch: 18.45283031463623

EPOCH 15 ------------------
step: 10	loss: 813.8479578495026	speed (wps):47427.29224388967
step: 30	loss: 2311.6684126853943	speed (wps):50120.29107897359
step: 50	loss: 3754.6888023614883	speed (wps):50739.06886568271
step: 70	loss: 5223.315681815147	speed (wps):51016.61274807099
step: 90	loss: 6689.435819983482	speed (wps):51164.30999685761
step: 110	loss: 8144.979668855667	speed (wps):47999.765198431174
step: 130	loss: 9600.992633104324	speed (wps):48524.65143030099
step: 150	loss: 11040.498030781746	speed (wps):48918.78852015068
step: 170	loss: 12471.849879026413	speed (wps):49232.84855630005
step: 190	loss: 13890.818491578102	speed (wps):49484.76773906812
epoch: 15	train ppl: 7.974793202135245	val ppl: 701.7418849652678	best val: 135.13459863464527	time (s) spent in epoch: 19.11941361427307

EPOCH 16 ------------------
step: 10	loss: 782.536489367485	speed (wps):46258.98033668888
step: 30	loss: 2215.614073872566	speed (wps):49644.957574162545
step: 50	loss: 3599.4942831993103	speed (wps):50450.27503852283
step: 70	loss: 5008.222482800484	speed (wps):50813.63242890696
step: 90	loss: 6414.203740358353	speed (wps):51010.58730552132
step: 110	loss: 7812.5806349515915	speed (wps):51133.79584922462
step: 130	loss: 9215.556716918945	speed (wps):51228.38246944526
step: 150	loss: 10601.538926959038	speed (wps):51297.56612544439
step: 170	loss: 11979.030067324638	speed (wps):51347.38025628015
step: 190	loss: 13341.785811185837	speed (wps):51388.736310431785
epoch: 16	train ppl: 7.349547659246036	val ppl: 783.1237808409063	best val: 135.13459863464527	time (s) spent in epoch: 18.47794198989868

EPOCH 17 ------------------
step: 10	loss: 756.2816745042801	speed (wps):47482.62861721561
step: 30	loss: 2135.24391412735	speed (wps):50136.183309758766
step: 50	loss: 3468.1752437353134	speed (wps):50761.308887691666
step: 70	loss: 4819.38098192215	speed (wps):51031.44362392027
step: 90	loss: 6169.59222137928	speed (wps):51183.51045119411
step: 110	loss: 7510.892283916473	speed (wps):51287.36654073324
step: 130	loss: 8860.57970046997	speed (wps):50399.59952112098
step: 150	loss: 10192.563645243645	speed (wps):50571.80396397673
step: 170	loss: 11519.828615188599	speed (wps):50704.48241162512
step: 190	loss: 12832.916299700737	speed (wps):50811.202955372166
epoch: 17	train ppl: 6.810938830350597	val ppl: 884.2069091304523	best val: 135.13459863464527	time (s) spent in epoch: 18.667762756347656

EPOCH 18 ------------------
step: 10	loss: 725.0733542442322	speed (wps):47456.23540664627
step: 30	loss: 2052.461983561516	speed (wps):50131.17384009711
step: 50	loss: 3336.531292796135	speed (wps):50755.708747697805
step: 70	loss: 4640.461950302124	speed (wps):51023.58999149584
step: 90	loss: 5942.294316291809	speed (wps):51197.30286726466
step: 110	loss: 7233.808618187904	speed (wps):51301.78909616825
step: 130	loss: 8543.182670474052	speed (wps):51368.74736773459
step: 150	loss: 9829.000242352486	speed (wps):51421.431780721236
step: 170	loss: 11109.01395559311	speed (wps):51460.31687668492
step: 190	loss: 12373.721882104874	speed (wps):51487.69033802476
epoch: 18	train ppl: 6.3685456314491695	val ppl: 986.5150675772215	best val: 135.13459863464527	time (s) spent in epoch: 18.446896076202393

EPOCH 19 ------------------
step: 10	loss: 702.9379093647003	speed (wps):46236.60821826859
step: 30	loss: 1986.8361991643906	speed (wps):49641.103364513365
step: 50	loss: 3226.7364817857742	speed (wps):50442.07216017375
step: 70	loss: 4488.8069105148315	speed (wps):50800.16581701717
step: 90	loss: 5747.336236834526	speed (wps):51003.279420582716
step: 110	loss: 6998.785448670387	speed (wps):51135.59732006711
step: 130	loss: 8266.698513627052	speed (wps):51225.76630854077
step: 150	loss: 9513.674325346947	speed (wps):51291.54135490371
step: 170	loss: 10751.74442589283	speed (wps):51342.11289596738
step: 190	loss: 11978.081802129745	speed (wps):51382.978521091696
epoch: 19	train ppl: 5.998182481380276	val ppl: 1118.0575015732	best val: 135.13459863464527	time (s) spent in epoch: 19.307311534881592

EPOCH 20 ------------------
step: 10	loss: 678.3386647701263	speed (wps):47425.485828589335
step: 30	loss: 1925.696394443512	speed (wps):50142.820996553644
step: 50	loss: 3123.0622547864914	speed (wps):50758.770793075324
step: 70	loss: 4341.693321466446	speed (wps):51026.29282027845
step: 90	loss: 5563.600318431854	speed (wps):51181.61074520165
step: 110	loss: 6773.285719752312	speed (wps):50069.03326243349
step: 130	loss: 7996.620828509331	speed (wps):50322.43342464295
step: 150	loss: 9198.449587225914	speed (wps):50510.62201939538
step: 170	loss: 10400.170574784279	speed (wps):50657.422679487565
step: 190	loss: 11589.682759046555	speed (wps):50770.4090457506
epoch: 20	train ppl: 5.6588497909061015	val ppl: 1249.5729349079545	best val: 135.13459863464527	time (s) spent in epoch: 18.68017888069153

EPOCH 21 ------------------
step: 10	loss: 655.1240479946136	speed (wps):46310.20095992228
step: 30	loss: 1864.0521097183228	speed (wps):49692.195885060406
step: 50	loss: 3029.6442246437073	speed (wps):50490.5686559339
step: 70	loss: 4212.546490430832	speed (wps):50854.00922971506
step: 90	loss: 5394.124919176102	speed (wps):51061.37578045554
step: 110	loss: 6563.9741241931915	speed (wps):51189.414089893675
step: 130	loss: 7754.470826983452	speed (wps):51280.110196838665
step: 150	loss: 8920.187410712242	speed (wps):51345.44176678411
step: 170	loss: 10089.148636460304	speed (wps):51396.64460333877
step: 190	loss: 11236.697923541069	speed (wps):51448.25109647394
epoch: 21	train ppl: 5.367785573472387	val ppl: 1389.9473506884212	best val: 135.13459863464527	time (s) spent in epoch: 18.458292961120605

EPOCH 22 ------------------
step: 10	loss: 639.372506737709	speed (wps):46276.44189431895
step: 30	loss: 1808.2007312774658	speed (wps):49671.0855099459
step: 50	loss: 2943.2271057367325	speed (wps):50464.74345995721
step: 70	loss: 4090.685995221138	speed (wps):50832.025107920366
step: 90	loss: 5239.458574652672	speed (wps):51039.93120864486
step: 110	loss: 6385.513255596161	speed (wps):51169.80420677822
step: 130	loss: 7540.680403113365	speed (wps):49775.74366055435
step: 150	loss: 8671.813205480576	speed (wps):50028.84745416404
step: 170	loss: 9811.483127474785	speed (wps):50227.745645399795
step: 190	loss: 10936.203091144562	speed (wps):50386.071646628705
epoch: 22	train ppl: 5.132345251645196	val ppl: 1525.1539184367857	best val: 135.13459863464527	time (s) spent in epoch: 18.809242725372314

EPOCH 23 ------------------
step: 10	loss: 619.6163761615753	speed (wps):47452.95602133618
step: 30	loss: 1760.297903418541	speed (wps):50178.711323417185
step: 50	loss: 2863.2222789525986	speed (wps):50794.364922940615
step: 70	loss: 3980.619319677353	speed (wps):51071.258341037654
step: 90	loss: 5105.248702168465	speed (wps):51225.28137682586
step: 110	loss: 6213.342742919922	speed (wps):49632.8146166293
step: 130	loss: 7339.164333939552	speed (wps):49951.1544772517
step: 150	loss: 8439.752449393272	speed (wps):50185.514440905885
step: 170	loss: 9540.956954956055	speed (wps):50378.444556087416
step: 190	loss: 10630.533557534218	speed (wps):50522.712750743616
epoch: 23	train ppl: 4.902560275083287	val ppl: 1678.9375024983863	best val: 135.13459863464527	time (s) spent in epoch: 18.762988567352295

EPOCH 24 ------------------
step: 10	loss: 603.9969474077225	speed (wps):47484.88664821905
step: 30	loss: 1712.1209871768951	speed (wps):50165.82912862564
step: 50	loss: 2782.0566821098328	speed (wps):50792.536919035076
step: 70	loss: 3867.7411103248596	speed (wps):51072.35123480988
step: 90	loss: 4959.216183423996	speed (wps):51247.14772277038
step: 110	loss: 6045.409076213837	speed (wps):51341.456647146144
step: 130	loss: 7138.157125711441	speed (wps):51409.13504676292
step: 150	loss: 8213.597502708435	speed (wps):51458.38147537798
step: 170	loss: 9286.70950114727	speed (wps):51494.989505393845
step: 190	loss: 10348.26954960823	speed (wps):51523.305069594135
epoch: 24	train ppl: 4.701334187076037	val ppl: 1809.6681744837815	best val: 135.13459863464527	time (s) spent in epoch: 18.764067888259888

EPOCH 25 ------------------
step: 10	loss: 587.9628020524979	speed (wps):47456.33346833555
step: 30	loss: 1666.385703086853	speed (wps):50155.82093361363
step: 50	loss: 2712.851305603981	speed (wps):50785.393081865994
step: 70	loss: 3774.9097216129303	speed (wps):51073.39920550359
step: 90	loss: 4838.356570601463	speed (wps):51229.39131047006
step: 110	loss: 5893.959402441978	speed (wps):51332.055759079616
step: 130	loss: 6963.302718997002	speed (wps):51399.34073536075
step: 150	loss: 8008.595059514046	speed (wps):51449.71212280754
step: 170	loss: 9063.699991106987	speed (wps):51486.069059832305
step: 190	loss: 10099.332234859467	speed (wps):51518.31206274798
epoch: 25	train ppl: 4.532343351685904	val ppl: 1971.2026312231117	best val: 135.13459863464527	time (s) spent in epoch: 18.436306715011597

EPOCH 26 ------------------
step: 10	loss: 573.1272196769714	speed (wps):47479.56371100621
step: 30	loss: 1625.6100368499756	speed (wps):50177.83818477847
step: 50	loss: 2648.9378893375397	speed (wps):50797.641659814595
step: 70	loss: 3683.1014662981033	speed (wps):51079.44738408945
step: 90	loss: 4724.447776079178	speed (wps):51230.037480266685
step: 110	loss: 5749.212473034859	speed (wps):49456.0480037798
step: 130	loss: 6794.382639527321	speed (wps):49801.40223316685
step: 150	loss: 7821.539280414581	speed (wps):50057.3781434665
step: 170	loss: 8843.032682538033	speed (wps):50251.1328390376
step: 190	loss: 9853.980687260628	speed (wps):50408.60312328717
epoch: 26	train ppl: 4.366261027754343	val ppl: 2219.907326361165	best val: 135.13459863464527	time (s) spent in epoch: 18.800938367843628

EPOCH 27 ------------------
step: 10	loss: 561.3937151432037	speed (wps):47473.3369530566
step: 30	loss: 1587.7072417736053	speed (wps):50162.36878733566
step: 50	loss: 2582.416461110115	speed (wps):50782.174435996836
step: 70	loss: 3591.931831240654	speed (wps):51059.78480266254
step: 90	loss: 4610.322571396828	speed (wps):51212.93099018222
step: 110	loss: 5619.676088690758	speed (wps):51312.89316316023
step: 130	loss: 6639.860390424728	speed (wps):51385.97029251524
step: 150	loss: 7644.190586805344	speed (wps):50975.03327676373
step: 170	loss: 8643.906337618828	speed (wps):51068.470678480306
step: 190	loss: 9635.791038870811	speed (wps):51153.22663981582
epoch: 27	train ppl: 4.227853426882714	val ppl: 2375.5761186797668	best val: 135.13459863464527	time (s) spent in epoch: 18.622654914855957

EPOCH 28 ------------------
step: 10	loss: 545.8072602748871	speed (wps):47421.10094706703
step: 30	loss: 1545.494881272316	speed (wps):50134.06031149469
step: 50	loss: 2518.6445742845535	speed (wps):50774.11077488867
step: 70	loss: 3509.6863865852356	speed (wps):51052.508521511976
step: 90	loss: 4498.944150209427	speed (wps):51211.81744682802
step: 110	loss: 5488.21315407753	speed (wps):51316.18315152885
step: 130	loss: 6490.108360648155	speed (wps):51399.9428425762
step: 150	loss: 7467.877426743507	speed (wps):51444.62346987678
step: 170	loss: 8442.537747621536	speed (wps):51485.59222358988
step: 190	loss: 9411.175917983055	speed (wps):51517.33738924704
epoch: 28	train ppl: 4.089844645908422	val ppl: 2565.076329503313	best val: 135.13459863464527	time (s) spent in epoch: 18.435930013656616

EPOCH 29 ------------------
step: 10	loss: 537.7372366189957	speed (wps):47609.04807149029
step: 30	loss: 1519.9266183376312	speed (wps):50212.51043096795
step: 50	loss: 2466.5791261196136	speed (wps):50815.67531403774
step: 70	loss: 3440.8000761270523	speed (wps):51086.39878978629
step: 90	loss: 4414.0408009290695	speed (wps):51237.03434805963
step: 110	loss: 5378.425869941711	speed (wps):48252.56781314308
step: 130	loss: 6354.783392548561	speed (wps):48761.3919281205
step: 150	loss: 7313.902945518494	speed (wps):49145.932631740856
step: 170	loss: 8277.788716554642	speed (wps):49451.15256741132
step: 190	loss: 9228.293648958206	speed (wps):49685.53765848956
epoch: 29	train ppl: 3.9776251045678697	val ppl: 2725.518950443629	best val: 135.13459863464527	time (s) spent in epoch: 19.04855442047119

EPOCH 30 ------------------
step: 10	loss: 529.0898633003235	speed (wps):47477.80783982778
step: 30	loss: 1492.4695605039597	speed (wps):50165.79456605276
step: 50	loss: 2420.5737674236298	speed (wps):50784.67181136942
step: 70	loss: 3368.6931771039963	speed (wps):51066.04476720147
step: 90	loss: 4322.748883366585	speed (wps):51219.8142535939
step: 110	loss: 5266.443195939064	speed (wps):51318.90029804545
step: 130	loss: 6225.5698627233505	speed (wps):51388.30031129594
step: 150	loss: 7163.03555727005	speed (wps):50044.94155958515
step: 170	loss: 8099.12584066391	speed (wps):50242.37884601935
step: 190	loss: 9022.947285175323	speed (wps):50401.26285946065
epoch: 30	train ppl: 3.8587484986885188	val ppl: 2991.0241101571264	best val: 135.13459863464527	time (s) spent in epoch: 18.803415536880493

EPOCH 31 ------------------
step: 10	loss: 512.9551774263382	speed (wps):47612.71099855592
step: 30	loss: 1456.5476769208908	speed (wps):50214.68769487659
step: 50	loss: 2369.1173285245895	speed (wps):50822.59587773128
step: 70	loss: 3300.2205443382263	speed (wps):51088.018578683674
step: 90	loss: 4232.918552160263	speed (wps):51239.09478172859
step: 110	loss: 5158.21417927742	speed (wps):51334.16686842294
step: 130	loss: 6095.563424229622	speed (wps):47914.08926489266
step: 150	loss: 7017.269078493118	speed (wps):48393.65082661462
step: 170	loss: 7940.572745800018	speed (wps):48767.71238155341
step: 190	loss: 8853.67072224617	speed (wps):49067.215089120466
epoch: 31	train ppl: 3.761837437562882	val ppl: 3215.7766276324996	best val: 135.13459863464527	time (s) spent in epoch: 19.265865564346313

EPOCH 32 ------------------
step: 10	loss: 508.61346423625946	speed (wps):47413.43207418409
step: 30	loss: 1436.0548013448715	speed (wps):50141.7937233164
step: 50	loss: 2337.619307041168	speed (wps):50775.084628004115
step: 70	loss: 3253.9489787817	speed (wps):51052.76835298593
step: 90	loss: 4173.429928421974	speed (wps):51209.25157329292
step: 110	loss: 5083.709478378296	speed (wps):49215.16098132942
step: 130	loss: 6009.352810382843	speed (wps):49589.8801260279
step: 150	loss: 6911.226460337639	speed (wps):49868.41693714231
step: 170	loss: 7813.318402171135	speed (wps):50084.813188760745
step: 190	loss: 8709.929974079132	speed (wps):50257.06634439249
epoch: 32	train ppl: 3.681714173894899	val ppl: 3444.5044705674964	best val: 135.13459863464527	time (s) spent in epoch: 18.85264563560486

EPOCH 33 ------------------
step: 10	loss: 497.6806288957596	speed (wps):46349.55876549057
step: 30	loss: 1412.9557913541794	speed (wps):49708.15709658354
step: 50	loss: 2294.1911101341248	speed (wps):50500.33609746843
step: 70	loss: 3189.0750348567963	speed (wps):50861.73705710281
step: 90	loss: 4086.5326207876205	speed (wps):51058.6313332844
step: 110	loss: 4974.998261928558	speed (wps):51185.091466319835
step: 130	loss: 5883.576996922493	speed (wps):51277.85941108082
step: 150	loss: 6772.152799963951	speed (wps):50604.331799768086
step: 170	loss: 7657.168854475021	speed (wps):50740.380682769704
step: 190	loss: 8536.614617109299	speed (wps):50850.10345575433
epoch: 33	train ppl: 3.5876668128675346	val ppl: 3660.240877892547	best val: 135.13459863464527	time (s) spent in epoch: 18.653993368148804

EPOCH 34 ------------------
step: 10	loss: 488.65431666374207	speed (wps):47461.084497805765
step: 30	loss: 1383.1411403417587	speed (wps):50155.05223442953
step: 50	loss: 2247.895728945732	speed (wps):50783.12437850175
step: 70	loss: 3131.7299139499664	speed (wps):51054.8138856011
step: 90	loss: 4009.568000435829	speed (wps):51209.564433527834
step: 110	loss: 4881.12614095211	speed (wps):51309.137840205614
step: 130	loss: 5771.186273694038	speed (wps):50347.43853797549
step: 150	loss: 6639.563425183296	speed (wps):50530.361514984725
step: 170	loss: 7511.114927530289	speed (wps):50673.163212481566
step: 190	loss: 8377.099229693413	speed (wps):50788.21678494857
epoch: 34	train ppl: 3.5043590951172634	val ppl: 3962.7397319742054	best val: 135.13459863464527	time (s) spent in epoch: 18.675058603286743

EPOCH 35 ------------------
step: 10	loss: 476.0353696346283	speed (wps):47459.76588279352
step: 30	loss: 1351.1082351207733	speed (wps):50145.12172334538
step: 50	loss: 2203.652514219284	speed (wps):50750.69843613119
step: 70	loss: 3068.881996870041	speed (wps):51031.677864794714
step: 90	loss: 3939.849911928177	speed (wps):51189.9444546662
step: 110	loss: 4798.453738093376	speed (wps):51309.142889010305
step: 130	loss: 5669.770138263702	speed (wps):51377.99383105857
step: 150	loss: 6528.360558748245	speed (wps):51432.29733833735
step: 170	loss: 7387.677906751633	speed (wps):51220.872514534116
step: 190	loss: 8232.891093492508	speed (wps):51280.302187516616
epoch: 35	train ppl: 3.4272679171481637	val ppl: 4120.737089585411	best val: 135.13459863464527	time (s) spent in epoch: 18.51304006576538

EPOCH 36 ------------------
step: 10	loss: 474.2854714393616	speed (wps):46303.50951842135
step: 30	loss: 1337.722652554512	speed (wps):49760.06791572348
step: 50	loss: 2176.0453695058823	speed (wps):50526.14712960701
step: 70	loss: 3027.5299948453903	speed (wps):50872.376839681216
step: 90	loss: 3883.207060098648	speed (wps):51065.708033272116
step: 110	loss: 4731.91625058651	speed (wps):51190.529724174776
step: 130	loss: 5586.036900877953	speed (wps):51279.86876470098
step: 150	loss: 6434.033675193787	speed (wps):49662.916798050035
step: 170	loss: 7276.034805774689	speed (wps):49900.52047845214
step: 190	loss: 8117.097926735878	speed (wps):50092.11393658348
epoch: 36	train ppl: 3.3700313186110717	val ppl: 4450.218860898366	best val: 135.13459863464527	time (s) spent in epoch: 19.95419955253601

EPOCH 37 ------------------
step: 10	loss: 465.6272041797638	speed (wps):47448.9037194634
step: 30	loss: 1315.906686782837	speed (wps):50169.622660457455
step: 50	loss: 2145.275560617447	speed (wps):50783.312756592124
step: 70	loss: 2988.2837402820587	speed (wps):51057.50634552419
step: 90	loss: 3828.5792660713196	speed (wps):51217.445478118374
step: 110	loss: 4664.241466522217	speed (wps):50706.26253943103
step: 130	loss: 5510.718250274658	speed (wps):50869.19203012383
step: 150	loss: 6341.692447066307	speed (wps):50984.88917936557
step: 170	loss: 7174.950749874115	speed (wps):49711.843938001504
step: 190	loss: 7990.734566450119	speed (wps):49918.23739477182
epoch: 37	train ppl: 3.305358693092322	val ppl: 4781.496765452703	best val: 135.13459863464527	time (s) spent in epoch: 18.968262434005737

EPOCH 38 ------------------
step: 10	loss: 455.2014398574829	speed (wps):47473.47869995505
step: 30	loss: 1289.6163779497147	speed (wps):50159.703656400416
step: 50	loss: 2102.263035774231	speed (wps):50776.38405373451
step: 70	loss: 2933.4250164031982	speed (wps):51049.61929560227
step: 90	loss: 3758.91221344471	speed (wps):51209.07674129725
step: 110	loss: 4577.130644321442	speed (wps):51307.50207979603
step: 130	loss: 5411.59891307354	speed (wps):51380.381039869295
step: 150	loss: 6235.975595712662	speed (wps):51440.72766940659
step: 170	loss: 7049.985206127167	speed (wps):51483.76333326678
step: 190	loss: 7863.725321888924	speed (wps):51514.93118330073
epoch: 38	train ppl: 3.2425332812484657	val ppl: 4984.4079787801875	best val: 135.13459863464527	time (s) spent in epoch: 18.436843872070312

EPOCH 39 ------------------
step: 10	loss: 450.86243867874146	speed (wps):47470.82926327365
step: 30	loss: 1273.346512913704	speed (wps):50153.17808911038
step: 50	loss: 2074.7944873571396	speed (wps):50773.00514715894
step: 70	loss: 2888.091898560524	speed (wps):51050.74837944272
step: 90	loss: 3700.639743208885	speed (wps):51207.267146907594
step: 110	loss: 4504.654690623283	speed (wps):51307.500817675485
step: 130	loss: 5324.6847450733185	speed (wps):51376.28345621702
step: 150	loss: 6128.615273833275	speed (wps):51440.43949501338
step: 170	loss: 6940.091602802277	speed (wps):51482.036029787676
step: 190	loss: 7730.347611308098	speed (wps):50450.16839771305
epoch: 39	train ppl: 3.1800208451413514	val ppl: 5291.287271935152	best val: 135.13459863464527	time (s) spent in epoch: 18.787578582763672

DONE

Saving learning curves to TRANSFORMER_ADAM_model=TRANSFORMER_optimizer=ADAM_initial_lr=0.001_batch_size=128_seq_len=35_hidden_size=512_num_layers=2_dp_keep_prob=.9_0/learning_curves.npy
