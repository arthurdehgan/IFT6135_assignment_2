Using the GPU

########## Setting Up Experiment ######################

Putting log in TRANSFORMER_SGD_model=TRANSFORMER_optimizer=SGD_initial_lr=20_batch_size=128_seq_len=35_hidden_size=512_num_layers=6_dp_keep_prob=.9_0
Using the GPU
Loading data from data
  vocabulary size: 10000

########## Running Main Loop ##########################

EPOCH 0 ------------------
step: 10	loss: 7618.98886680603	speed (wps):20829.31176253037
step: 30	loss: 20959.978790283203	speed (wps):23878.030640357032
step: 50	loss: 30473.324298858643	speed (wps):24674.698998484575
step: 70	loss: 38844.91216659546	speed (wps):25040.14056909251
step: 90	loss: 47124.39218521118	speed (wps):25247.94186570874
step: 110	loss: 54648.83746623993	speed (wps):25389.114337407536
step: 130	loss: 62741.69812679291	speed (wps):25484.10135452814
step: 150	loss: 70064.77638244629	speed (wps):25555.26665001869
step: 170	loss: 76983.72212409973	speed (wps):25604.79686480866
step: 190	loss: 83556.0988521576	speed (wps):25641.86079449256
epoch: 0	train ppl: 203757.33367416434	val ppl: 3069.5499556084583	best val: 3069.5499556084583	time (s) spent in epoch: 37.02628803253174

EPOCH 1 ------------------
step: 10	loss: 3720.141236782074	speed (wps):24853.795889783716
step: 30	loss: 9941.510848999023	speed (wps):25631.34368264679
step: 50	loss: 15932.982559204102	speed (wps):25796.544777805437
step: 70	loss: 22084.477157592773	speed (wps):25879.17606823521
step: 90	loss: 27765.57267189026	speed (wps):25916.130561725822
step: 110	loss: 33417.445805072784	speed (wps):25940.252266024756
step: 130	loss: 39163.43122243881	speed (wps):25963.564791908866
step: 150	loss: 44515.92447280884	speed (wps):25979.85360095394
step: 170	loss: 49705.88756799698	speed (wps):25989.85948636359
step: 190	loss: 55197.27198123932	speed (wps):25995.611338822328
epoch: 1	train ppl: 3601.038167234069	val ppl: 2068.2414458277262	best val: 2068.2414458277262	time (s) spent in epoch: 36.56388211250305

EPOCH 2 ------------------
step: 10	loss: 2871.4278531074524	speed (wps):24791.638289570757
step: 30	loss: 7997.71782875061	speed (wps):25563.088158115028
step: 50	loss: 13262.210783958435	speed (wps):25733.13833552011
step: 70	loss: 18204.60087299347	speed (wps):25815.855355813277
step: 90	loss: 23204.202251434326	speed (wps):25866.8299383621
step: 110	loss: 28082.01230764389	speed (wps):25896.798958428302
step: 130	loss: 32915.84829330444	speed (wps):25916.608014905745
step: 150	loss: 37684.641885757446	speed (wps):25927.757578664008
step: 170	loss: 42457.054052352905	speed (wps):25933.51368940023
step: 190	loss: 47148.40576887131	speed (wps):25938.87111068749
epoch: 2	train ppl: 1132.2561072981646	val ppl: 661.6603628782505	best val: 661.6603628782505	time (s) spent in epoch: 36.638514041900635

EPOCH 3 ------------------
step: 10	loss: 2627.3040747642517	speed (wps):24776.50605443931
step: 30	loss: 7329.2313504219055	speed (wps):25555.024745170307
step: 50	loss: 12136.233561038971	speed (wps):25730.287589517648
step: 70	loss: 16845.745906829834	speed (wps):25803.65318477177
step: 90	loss: 21541.43332004547	speed (wps):25849.160845883172
step: 110	loss: 26052.18600988388	speed (wps):25878.508378843835
step: 130	loss: 30540.065729618073	speed (wps):25903.12461042894
step: 150	loss: 35024.96791124344	speed (wps):25917.709361073496
step: 170	loss: 39434.5938706398	speed (wps):25929.73264813542
step: 190	loss: 43935.69638967514	speed (wps):25939.89642246564
epoch: 3	train ppl: 702.2056992926377	val ppl: 508.87465316179754	best val: 508.87465316179754	time (s) spent in epoch: 36.63811898231506

EPOCH 4 ------------------
step: 10	loss: 2398.219141960144	speed (wps):24816.167821138955
step: 30	loss: 6805.118086338043	speed (wps):25581.543234242035
step: 50	loss: 11230.0191116333	speed (wps):25755.69363827919
step: 70	loss: 15658.537242412567	speed (wps):25829.910278654
step: 90	loss: 20081.03527545929	speed (wps):25871.311071232783
step: 110	loss: 24446.210718154907	speed (wps):25895.974241684795
step: 130	loss: 28813.102922439575	speed (wps):25912.47450358076
step: 150	loss: 33206.14393949509	speed (wps):25923.298189934532
step: 170	loss: 37661.90556764603	speed (wps):25931.586721109048
step: 190	loss: 42074.971091747284	speed (wps):25938.085636842956
epoch: 4	train ppl: 542.3036053159851	val ppl: 648.916221711822	best val: 508.87465316179754	time (s) spent in epoch: 36.64467477798462

EPOCH 5 ------------------
step: 10	loss: 2456.2387776374817	speed (wps):24752.051864810728
step: 30	loss: 6864.296126365662	speed (wps):25541.627633763437
step: 50	loss: 11237.513675689697	speed (wps):25712.224296262993
step: 70	loss: 15671.940836906433	speed (wps):25788.84812946389
step: 90	loss: 20082.290861606598	speed (wps):25831.93264789652
step: 110	loss: 24428.757581710815	speed (wps):25859.16570427786
step: 130	loss: 28748.098781108856	speed (wps):25873.85910353843
step: 150	loss: 33081.146886348724	speed (wps):25893.395889327945
step: 170	loss: 37422.60402917862	speed (wps):25903.787565963947
step: 190	loss: 41741.452593803406	speed (wps):25913.27417481585
epoch: 5	train ppl: 515.6055479519521	val ppl: 445.91267515617426	best val: 445.91267515617426	time (s) spent in epoch: 36.67449879646301

EPOCH 6 ------------------
step: 10	loss: 2363.9657378196716	speed (wps):24420.58870434076
step: 30	loss: 6680.4129457473755	speed (wps):25425.13030519762
step: 50	loss: 10960.084612369537	speed (wps):25657.966435617287
step: 70	loss: 15314.083731174469	speed (wps):25755.81980651265
step: 90	loss: 19670.75138568878	speed (wps):25798.27094084412
step: 110	loss: 23943.11223745346	speed (wps):25834.390790341353
step: 130	loss: 28162.30469942093	speed (wps):25861.73432790139
step: 150	loss: 32363.618681430817	speed (wps):25882.967695691266
step: 170	loss: 36525.60359239578	speed (wps):25895.43894427325
step: 190	loss: 40711.777408123016	speed (wps):25906.22467630411
epoch: 6	train ppl: 439.9447255973615	val ppl: 507.8211261763052	best val: 445.91267515617426	time (s) spent in epoch: 36.68242526054382

EPOCH 7 ------------------
step: 10	loss: 2319.536883831024	speed (wps):24795.477777852422
step: 30	loss: 6551.045565605164	speed (wps):25549.179429598025
step: 50	loss: 10720.92323064804	speed (wps):25723.46108024116
step: 70	loss: 14906.308176517487	speed (wps):25801.294271232262
step: 90	loss: 19105.53457736969	speed (wps):25838.417763327045
step: 110	loss: 23252.90096282959	speed (wps):25860.634151222945
step: 130	loss: 27418.821160793304	speed (wps):25875.140394650916
step: 150	loss: 31584.836938381195	speed (wps):25886.65554154177
step: 170	loss: 35714.12480592728	speed (wps):25896.68637575736
step: 190	loss: 39830.74035406113	speed (wps):25903.616503765257
epoch: 7	train ppl: 385.392028704554	val ppl: 363.3069666478534	best val: 363.3069666478534	time (s) spent in epoch: 36.68981456756592

EPOCH 8 ------------------
step: 10	loss: 2271.1073541641235	speed (wps):24777.45647573606
step: 30	loss: 6394.166774749756	speed (wps):25565.54071362321
step: 50	loss: 10505.595638751984	speed (wps):25722.470970929997
step: 70	loss: 14584.666368961334	speed (wps):25796.55329653703
step: 90	loss: 18691.615691184998	speed (wps):25837.505731426205
step: 110	loss: 22768.507299423218	speed (wps):25867.49349376095
step: 130	loss: 26759.546942710876	speed (wps):25886.292793658773
step: 150	loss: 30810.281159877777	speed (wps):25902.326843653616
step: 170	loss: 34839.59873199463	speed (wps):25913.6744180795
step: 190	loss: 38813.50705862045	speed (wps):25921.320653764546
epoch: 8	train ppl: 331.23519527542993	val ppl: 299.3225766952304	best val: 299.3225766952304	time (s) spent in epoch: 36.663211822509766

EPOCH 9 ------------------
step: 10	loss: 2219.0551447868347	speed (wps):24801.94008137429
step: 30	loss: 6251.011929512024	speed (wps):25562.104351129146
step: 50	loss: 10237.420942783356	speed (wps):25731.86143274479
step: 70	loss: 14250.568869113922	speed (wps):25803.758490101554
step: 90	loss: 18228.196289539337	speed (wps):25848.392237648244
step: 110	loss: 22191.810438632965	speed (wps):25884.98399941234
step: 130	loss: 26164.15155649185	speed (wps):25899.92436333147
step: 150	loss: 30108.033027648926	speed (wps):25911.665284690007
step: 170	loss: 34028.91285419464	speed (wps):25920.755445656087
step: 190	loss: 37866.3551235199	speed (wps):25929.17711990163
epoch: 9	train ppl: 285.16126413926906	val ppl: 271.3253195966113	best val: 271.3253195966113	time (s) spent in epoch: 36.661033391952515

EPOCH 10 ------------------
step: 10	loss: 2137.9088282585144	speed (wps):24812.953390802577
step: 30	loss: 6054.529044628143	speed (wps):25550.78312244941
step: 50	loss: 9944.418008327484	speed (wps):25109.923428606613
step: 70	loss: 13872.471747398376	speed (wps):25353.6936905606
step: 90	loss: 17757.516791820526	speed (wps):25492.03437359616
step: 110	loss: 21639.049422740936	speed (wps):25580.96340532885
step: 130	loss: 25498.590495586395	speed (wps):25642.93125453013
step: 150	loss: 29378.76136302948	speed (wps):25689.02934059007
step: 170	loss: 33177.45631694794	speed (wps):25724.589566861665
step: 190	loss: 36931.554906368256	speed (wps):25752.232809902172
epoch: 10	train ppl: 249.59406580895165	val ppl: 273.23431326097915	best val: 271.3253195966113	time (s) spent in epoch: 36.8824028968811

EPOCH 11 ------------------
step: 10	loss: 2113.896563053131	speed (wps):24515.69735579087
step: 30	loss: 5957.861461639404	speed (wps):25453.541760168493
step: 50	loss: 9768.095915317535	speed (wps):25666.132959205745
step: 70	loss: 13585.43428659439	speed (wps):25759.6723983681
step: 90	loss: 17346.4772939682	speed (wps):25816.811805086643
step: 110	loss: 21095.066177845	speed (wps):25850.110227469533
step: 130	loss: 24863.20240497589	speed (wps):25874.05600778145
step: 150	loss: 28573.8428068161	speed (wps):25890.51595272363
step: 170	loss: 32247.966718673706	speed (wps):25903.66226867902
step: 190	loss: 35951.787889003754	speed (wps):25913.87496616251
epoch: 11	train ppl: 215.7594082725885	val ppl: 252.56953678838272	best val: 252.56953678838272	time (s) spent in epoch: 36.67290472984314

EPOCH 12 ------------------
step: 10	loss: 2060.0673937797546	speed (wps):24787.32437355719
step: 30	loss: 5799.215040206909	speed (wps):25550.664323482266
step: 50	loss: 9506.054487228394	speed (wps):25152.7713761774
step: 70	loss: 13217.63905286789	speed (wps):25387.22022653187
step: 90	loss: 16947.008621692657	speed (wps):25519.917995212607
step: 110	loss: 20626.79913520813	speed (wps):25607.307828755766
step: 130	loss: 24325.850837230682	speed (wps):25665.86901932993
step: 150	loss: 27976.278445720673	speed (wps):25712.470561603375
step: 170	loss: 31592.759082317352	speed (wps):25743.1403345283
step: 190	loss: 35136.70902013779	speed (wps):25769.98128626152
epoch: 12	train ppl: 189.59551219762713	val ppl: 225.41575286825793	best val: 225.41575286825793	time (s) spent in epoch: 36.85473656654358

EPOCH 13 ------------------
step: 10	loss: 2005.2342128753662	speed (wps):24821.016363870203
step: 30	loss: 5631.379573345184	speed (wps):25577.78022932075
step: 50	loss: 9265.158603191376	speed (wps):25735.419525401827
step: 70	loss: 12896.811165809631	speed (wps):25806.065940623022
step: 90	loss: 16531.079592704773	speed (wps):25847.86435882565
step: 110	loss: 20131.51625394821	speed (wps):25874.45662224839
step: 130	loss: 23731.765694618225	speed (wps):25893.57417957563
step: 150	loss: 27312.25276708603	speed (wps):25907.909985933813
step: 170	loss: 30808.38585615158	speed (wps):25918.99972258559
step: 190	loss: 34295.54287195206	speed (wps):25925.370955845832
epoch: 13	train ppl: 168.32699365567916	val ppl: 228.06817888657216	best val: 225.41575286825793	time (s) spent in epoch: 36.65946698188782

EPOCH 14 ------------------
step: 10	loss: 1978.3003187179565	speed (wps):24538.67851641499
step: 30	loss: 5524.221529960632	speed (wps):25461.348711828407
step: 50	loss: 9075.443363189697	speed (wps):25663.527270825416
step: 70	loss: 12599.533100128174	speed (wps):25756.424448440073
step: 90	loss: 16142.93219089508	speed (wps):25808.058238271988
step: 110	loss: 19637.454645633698	speed (wps):25842.756420602218
step: 130	loss: 23163.439452648163	speed (wps):25866.173749053618
step: 150	loss: 26615.891551971436	speed (wps):25884.160339215214
step: 170	loss: 30094.909012317657	speed (wps):25897.22215911473
step: 190	loss: 33488.53558301926	speed (wps):25906.33930658741
epoch: 14	train ppl: 148.62723648135602	val ppl: 261.6466203533046	best val: 225.41575286825793	time (s) spent in epoch: 36.68289279937744

EPOCH 15 ------------------
step: 10	loss: 1943.2479310035706	speed (wps):24787.639467520137
step: 30	loss: 5462.881875038147	speed (wps):25556.85566908992
step: 50	loss: 8913.692481517792	speed (wps):25729.189191424135
step: 70	loss: 12320.122916698456	speed (wps):25810.101851417996
step: 90	loss: 15777.877173423767	speed (wps):25853.933335518654
step: 110	loss: 19174.416377544403	speed (wps):25878.078776653572
step: 130	loss: 22635.155415534973	speed (wps):25897.11669020467
step: 150	loss: 26045.599377155304	speed (wps):25909.684579101086
step: 170	loss: 29404.74069595337	speed (wps):25920.503687500008
step: 190	loss: 32683.749089241028	speed (wps):25929.846465497158
epoch: 15	train ppl: 131.35436331157896	val ppl: 203.26170009405948	best val: 203.26170009405948	time (s) spent in epoch: 36.65425634384155

EPOCH 16 ------------------
step: 10	loss: 1886.1331057548523	speed (wps):24508.313880973208
step: 30	loss: 5332.546098232269	speed (wps):25450.61358047206
step: 50	loss: 8737.82612323761	speed (wps):25663.6186774742
step: 70	loss: 12128.909027576447	speed (wps):25756.450305471244
step: 90	loss: 15513.041038513184	speed (wps):25810.053521253893
step: 110	loss: 18822.411274909973	speed (wps):25842.67765246874
step: 130	loss: 22160.570137500763	speed (wps):25866.586897088513
step: 150	loss: 25509.200468063354	speed (wps):25885.142682112382
step: 170	loss: 28822.887592315674	speed (wps):25895.62468436112
step: 190	loss: 32068.77892255783	speed (wps):25904.752711661582
epoch: 16	train ppl: 119.50547248366613	val ppl: 190.85787439701485	best val: 190.85787439701485	time (s) spent in epoch: 36.68391537666321

EPOCH 17 ------------------
step: 10	loss: 1858.6778712272644	speed (wps):24786.81905090827
step: 30	loss: 5216.317887306213	speed (wps):25551.4712815961
step: 50	loss: 8481.051955223083	speed (wps):25719.65917233018
step: 70	loss: 11785.365884304047	speed (wps):25799.37282652303
step: 90	loss: 15098.605318069458	speed (wps):25844.39050849052
step: 110	loss: 18333.674821853638	speed (wps):25873.124612762498
step: 130	loss: 21580.220205783844	speed (wps):25892.488247125744
step: 150	loss: 24816.807951927185	speed (wps):25908.32469044606
step: 170	loss: 28047.313899993896	speed (wps):25918.51488635087
step: 190	loss: 31205.5668258667	speed (wps):25926.013885187203
epoch: 17	train ppl: 106.20057940635972	val ppl: 198.37645178972977	best val: 190.85787439701485	time (s) spent in epoch: 36.656867265701294

EPOCH 18 ------------------
step: 10	loss: 1805.8783149719238	speed (wps):24482.52990472206
step: 30	loss: 5105.268616676331	speed (wps):25435.991667545455
step: 50	loss: 8269.777059555054	speed (wps):25648.97443187034
step: 70	loss: 11480.17029762268	speed (wps):25744.037444322847
step: 90	loss: 14732.868542671204	speed (wps):25798.268216262124
step: 110	loss: 17898.984265327454	speed (wps):25836.092285880528
step: 130	loss: 21116.54315471649	speed (wps):25859.80369875352
step: 150	loss: 24313.384013175964	speed (wps):25878.10003550054
step: 170	loss: 27471.315820217133	speed (wps):25892.26612208099
step: 190	loss: 30570.238716602325	speed (wps):25902.34598353031
epoch: 18	train ppl: 96.10499621344273	val ppl: 182.51584633074623	best val: 182.51584633074623	time (s) spent in epoch: 36.68470788002014

EPOCH 19 ------------------
step: 10	loss: 1743.8760113716125	speed (wps):24811.28245436337
step: 30	loss: 4952.085738182068	speed (wps):25550.536559788252
step: 50	loss: 8087.191255092621	speed (wps):25696.282178050566
step: 70	loss: 11221.210615634918	speed (wps):25777.197900385738
step: 90	loss: 14407.318217754364	speed (wps):25823.61340815081
step: 110	loss: 17509.16546344757	speed (wps):25852.52162396807
step: 130	loss: 20656.963410377502	speed (wps):25873.927638929403
step: 150	loss: 23715.031883716583	speed (wps):25888.15133491786
step: 170	loss: 26770.027055740356	speed (wps):25899.53314844278
step: 190	loss: 29747.469551563263	speed (wps):25908.340357483612
epoch: 19	train ppl: 85.3961776602063	val ppl: 191.90844077356763	best val: 182.51584633074623	time (s) spent in epoch: 36.68425250053406

EPOCH 20 ------------------
step: 10	loss: 1709.5338869094849	speed (wps):24797.60770468509
step: 30	loss: 4830.635311603546	speed (wps):25541.16062434432
step: 50	loss: 7862.1104526519775	speed (wps):25709.89893370601
step: 70	loss: 10972.486531734467	speed (wps):25783.655772701324
step: 90	loss: 14059.878089427948	speed (wps):25832.495780000387
step: 110	loss: 17047.67130613327	speed (wps):25857.528165825803
step: 130	loss: 20170.40395975113	speed (wps):25876.358432400208
step: 150	loss: 23177.647488117218	speed (wps):25890.808193724333
step: 170	loss: 26147.796976566315	speed (wps):25900.883695247256
step: 190	loss: 29038.70708465576	speed (wps):25909.250657408113
epoch: 20	train ppl: 76.53622369121156	val ppl: 209.85462163940514	best val: 182.51584633074623	time (s) spent in epoch: 36.67928647994995

EPOCH 21 ------------------
step: 10	loss: 1673.5799598693848	speed (wps):24820.107304074
step: 30	loss: 4787.367265224457	speed (wps):25562.376937726935
step: 50	loss: 7750.005917549133	speed (wps):25725.164605664835
step: 70	loss: 10717.863631248474	speed (wps):25798.291734302722
step: 90	loss: 13676.472259759903	speed (wps):25838.354902898125
step: 110	loss: 16620.944875478745	speed (wps):25866.8602304666
step: 130	loss: 19705.288132429123	speed (wps):25887.337641388323
step: 150	loss: 22629.8040163517	speed (wps):25902.316202835307
step: 170	loss: 25555.08558869362	speed (wps):25913.945061996976
step: 190	loss: 28433.80210995674	speed (wps):25921.975926330488
epoch: 21	train ppl: 69.41899891522255	val ppl: 184.00886579644327	best val: 182.51584633074623	time (s) spent in epoch: 36.66405940055847

EPOCH 22 ------------------
step: 10	loss: 1588.30739736557	speed (wps):24803.913361693078
step: 30	loss: 4695.0950264930725	speed (wps):25560.68878911992
step: 50	loss: 7591.333227157593	speed (wps):24770.080976487236
step: 70	loss: 10538.109475374222	speed (wps):25106.48829421116
step: 90	loss: 13542.421878576279	speed (wps):25296.30111491029
step: 110	loss: 16434.850679636	speed (wps):25416.555808380785
step: 130	loss: 19381.289294958115	speed (wps):25502.410539832264
step: 150	loss: 22270.121426582336	speed (wps):25563.816818568732
step: 170	loss: 25064.994523525238	speed (wps):25612.847629477597
step: 190	loss: 27839.090309143066	speed (wps):25651.622709614545
epoch: 22	train ppl: 63.35050429994606	val ppl: 215.91581771526816	best val: 182.51584633074623	time (s) spent in epoch: 37.01004505157471

EPOCH 23 ------------------
step: 10	loss: 1567.2846364974976	speed (wps):24817.43118019113
step: 30	loss: 4618.364365100861	speed (wps):25567.972416846857
step: 50	loss: 7447.417833805084	speed (wps):25735.510753764538
step: 70	loss: 10259.198093414307	speed (wps):25807.58350268225
step: 90	loss: 13104.380110502243	speed (wps):25848.225783523285
step: 110	loss: 15874.50914144516	speed (wps):25872.81971421854
step: 130	loss: 18821.304916143417	speed (wps):25888.758039960736
step: 150	loss: 21641.103266477585	speed (wps):25900.148732190984
step: 170	loss: 24379.305473566055	speed (wps):25913.60189900944
step: 190	loss: 27016.402512788773	speed (wps):25920.967756408187
epoch: 23	train ppl: 55.94322509923073	val ppl: 201.09203807678497	best val: 182.51584633074623	time (s) spent in epoch: 36.66466283798218

EPOCH 24 ------------------
step: 10	loss: 1515.197137594223	speed (wps):24788.81073606572
step: 30	loss: 4529.718219041824	speed (wps):25547.143444393245
step: 50	loss: 7298.711860179901	speed (wps):25719.083495628398
step: 70	loss: 10027.92475104332	speed (wps):25792.90458639051
step: 90	loss: 12790.512696504593	speed (wps):25841.50845288793
step: 110	loss: 15507.294011116028	speed (wps):25870.746273788478
step: 130	loss: 18379.46759223938	speed (wps):25887.803467025096
step: 150	loss: 21200.243426561356	speed (wps):25904.359400267957
step: 170	loss: 23912.798451185226	speed (wps):25915.266387062424
step: 190	loss: 26480.36394238472	speed (wps):25921.236781267733
epoch: 24	train ppl: 51.48708037687584	val ppl: 240.01270277857273	best val: 182.51584633074623	time (s) spent in epoch: 36.663761377334595

EPOCH 25 ------------------
step: 10	loss: 1456.9058668613434	speed (wps):24502.0966092097
step: 30	loss: 4344.944764375687	speed (wps):25436.898033052315
step: 50	loss: 7030.172978639603	speed (wps):25652.593412044167
step: 70	loss: 9755.328975915909	speed (wps):25749.55776395679
step: 90	loss: 12510.220183134079	speed (wps):25802.60570103012
step: 110	loss: 15118.335417509079	speed (wps):25834.864703292573
step: 130	loss: 17840.688021183014	speed (wps):25859.08841216911
step: 150	loss: 20496.514486074448	speed (wps):25877.37736060749
step: 170	loss: 23117.525309324265	speed (wps):25892.225645190094
step: 190	loss: 25721.99122786522	speed (wps):25902.28597528325
epoch: 25	train ppl: 46.178591320321	val ppl: 236.5066292632929	best val: 182.51584633074623	time (s) spent in epoch: 36.686816692352295

EPOCH 26 ------------------
step: 10	loss: 1415.0331628322601	speed (wps):24788.769115489747
step: 30	loss: 4220.374264717102	speed (wps):25547.145685255255
step: 50	loss: 6854.105046987534	speed (wps):25722.301817618154
step: 70	loss: 9551.284819841385	speed (wps):25798.942773449133
step: 90	loss: 12154.104388952255	speed (wps):25843.046458678014
step: 110	loss: 14648.727806806564	speed (wps):25872.16147881333
step: 130	loss: 17418.385890722275	speed (wps):25891.795934430997
step: 150	loss: 20073.417661190033	speed (wps):25906.203284245545
step: 170	loss: 22626.726100444794	speed (wps):25917.231067399745
step: 190	loss: 25140.69547176361	speed (wps):25924.417763629932
epoch: 26	train ppl: 42.10505736143203	val ppl: 254.29854521384985	best val: 182.51584633074623	time (s) spent in epoch: 36.66020178794861

EPOCH 27 ------------------
step: 10	loss: 1376.8635475635529	speed (wps):24449.116602699683
step: 30	loss: 4205.119317770004	speed (wps):25417.84907476105
step: 50	loss: 6727.919390201569	speed (wps):25661.484880050917
step: 70	loss: 9249.148281812668	speed (wps):25750.89621413301
step: 90	loss: 11781.94210767746	speed (wps):25806.55438368976
step: 110	loss: 14257.684777975082	speed (wps):25843.66100777421
step: 130	loss: 16885.062527656555	speed (wps):25867.517615751305
step: 150	loss: 19503.56667637825	speed (wps):25881.425993155517
step: 170	loss: 21996.479048728943	speed (wps):25892.8117378832
step: 190	loss: 24409.7221159935	speed (wps):25902.31943779171
epoch: 27	train ppl: 37.661419153486676	val ppl: 260.93873964011635	best val: 182.51584633074623	time (s) spent in epoch: 36.68930697441101

EPOCH 28 ------------------
step: 10	loss: 1310.2126562595367	speed (wps):24805.705360326363
step: 30	loss: 4071.785708665848	speed (wps):25545.227651218025
step: 50	loss: 6558.395792245865	speed (wps):25719.979464050804
step: 70	loss: 9092.890090942383	speed (wps):25792.88164806659
step: 90	loss: 11550.657016038895	speed (wps):25835.60691268525
step: 110	loss: 13921.186805963516	speed (wps):25862.505861256308
step: 130	loss: 16459.25334095955	speed (wps):25879.257377332076
step: 150	loss: 18945.708431005478	speed (wps):25893.677797930548
step: 170	loss: 21403.40541124344	speed (wps):25905.676151693435
step: 190	loss: 23779.764924049377	speed (wps):25915.116303168576
epoch: 28	train ppl: 34.310028699370996	val ppl: 308.3159646362672	best val: 182.51584633074623	time (s) spent in epoch: 36.67188215255737

EPOCH 29 ------------------
step: 10	loss: 1286.1070227622986	speed (wps):24825.690876729535
step: 30	loss: 3970.8746790885925	speed (wps):25563.686107454694
step: 50	loss: 6354.6512842178345	speed (wps):25735.795500995915
step: 70	loss: 8743.946957588196	speed (wps):25811.338238939894
step: 90	loss: 11144.8712515831	speed (wps):25851.49860237008
step: 110	loss: 13466.480078697205	speed (wps):25875.827611851473
step: 130	loss: 15886.623612642288	speed (wps):25893.597331873603
step: 150	loss: 18433.027271032333	speed (wps):25906.49067564556
step: 170	loss: 20907.59488940239	speed (wps):25913.476506762403
step: 190	loss: 23174.556262493134	speed (wps):25921.496450781196
epoch: 29	train ppl: 31.172559862378048	val ppl: 337.9226917801544	best val: 182.51584633074623	time (s) spent in epoch: 36.66342258453369

EPOCH 30 ------------------
step: 10	loss: 1231.4244294166565	speed (wps):24802.719831851256
step: 30	loss: 3884.556665420532	speed (wps):25551.912888587016
step: 50	loss: 6202.713694572449	speed (wps):25723.64129662037
step: 70	loss: 8633.839163780212	speed (wps):25795.666459289336
step: 90	loss: 11032.949614524841	speed (wps):25838.39277529383
step: 110	loss: 13270.821954011917	speed (wps):25866.868891913455
step: 130	loss: 15783.404285907745	speed (wps):25884.12006359396
step: 150	loss: 18163.938109874725	speed (wps):25896.60003700632
step: 170	loss: 20466.111562252045	speed (wps):25906.53564021947
step: 190	loss: 22684.2289352417	speed (wps):25914.95163299202
epoch: 30	train ppl: 28.955638067673707	val ppl: 392.7455925370352	best val: 182.51584633074623	time (s) spent in epoch: 36.67150163650513

EPOCH 31 ------------------
step: 10	loss: 1303.1775152683258	speed (wps):24801.23477680121
step: 30	loss: 3898.0153596401215	speed (wps):25560.300714716992
step: 50	loss: 6124.324325323105	speed (wps):25730.712466763434
step: 70	loss: 8378.031022548676	speed (wps):25806.139817800857
step: 90	loss: 10654.796316623688	speed (wps):25848.93576827634
step: 110	loss: 12844.386910200119	speed (wps):25875.18944642789
step: 130	loss: 15195.100976228714	speed (wps):25894.74219655407
step: 150	loss: 17605.372346639633	speed (wps):25908.53050993668
step: 170	loss: 19826.82225584984	speed (wps):25918.737963124462
step: 190	loss: 21948.064839839935	speed (wps):25925.527892836377
epoch: 31	train ppl: 26.097616604305138	val ppl: 365.44327410630535	best val: 182.51584633074623	time (s) spent in epoch: 36.659629821777344

EPOCH 32 ------------------
step: 10	loss: 1224.3284225463867	speed (wps):24820.584179598
step: 30	loss: 3617.882137298584	speed (wps):25560.64055957889
step: 50	loss: 5788.189353942871	speed (wps):25729.323895578927
step: 70	loss: 8135.146833658218	speed (wps):25799.174760855312
step: 90	loss: 10333.859965801239	speed (wps):25838.933933198572
step: 110	loss: 12408.82523059845	speed (wps):25865.678799314854
step: 130	loss: 14797.026377916336	speed (wps):25885.34711311945
step: 150	loss: 17146.50336623192	speed (wps):25899.06005022406
step: 170	loss: 19357.24720597267	speed (wps):25910.778777512638
step: 190	loss: 21400.782854557037	speed (wps):25919.10476740878
epoch: 32	train ppl: 23.977428971922564	val ppl: 388.01216108276395	best val: 182.51584633074623	time (s) spent in epoch: 36.66480565071106

EPOCH 33 ------------------
step: 10	loss: 1164.1951704025269	speed (wps):24797.560104557622
step: 30	loss: 3603.7966096401215	speed (wps):25562.16716892425
step: 50	loss: 5806.594272851944	speed (wps):25730.260646555664
step: 70	loss: 7951.87663435936	speed (wps):25798.524208877505
step: 90	loss: 10081.367871761322	speed (wps):25837.890682243862
step: 110	loss: 12162.189428806305	speed (wps):25863.805026416627
step: 130	loss: 14456.035362482071	speed (wps):25882.259568908543
step: 150	loss: 16670.77309370041	speed (wps):25895.996864986235
step: 170	loss: 18770.972814559937	speed (wps):25910.189363969464
step: 190	loss: 20734.365832805634	speed (wps):25920.067864840377
epoch: 33	train ppl: 21.848108342326782	val ppl: 512.3956541248762	best val: 182.51584633074623	time (s) spent in epoch: 36.668888092041016

EPOCH 34 ------------------
step: 10	loss: 1165.8430886268616	speed (wps):24798.55677036986
step: 30	loss: 3413.840901851654	speed (wps):25555.112193010576
step: 50	loss: 5507.986378669739	speed (wps):25729.276921662215
step: 70	loss: 7740.1409304142	speed (wps):25802.405556709527
step: 90	loss: 9783.0111682415	speed (wps):25841.850563280434
step: 110	loss: 11741.603116989136	speed (wps):25869.613579511366
step: 130	loss: 14001.826877593994	speed (wps):25887.541284899406
step: 150	loss: 16092.767516374588	speed (wps):25900.431497138066
step: 170	loss: 18168.00036907196	speed (wps):25912.769735160542
step: 190	loss: 20117.560769319534	speed (wps):25922.464968473567
epoch: 34	train ppl: 19.837780620040895	val ppl: 517.0972822059995	best val: 182.51584633074623	time (s) spent in epoch: 36.66259503364563

EPOCH 35 ------------------
step: 10	loss: 1195.6840586662292	speed (wps):24813.28403056605
step: 30	loss: 3505.0894105434418	speed (wps):25555.38463050342
step: 50	loss: 5527.015327215195	speed (wps):25725.44912399373
step: 70	loss: 7695.199389457703	speed (wps):25800.26391019157
step: 90	loss: 9677.111414670944	speed (wps):25839.72775055955
step: 110	loss: 11592.980765104294	speed (wps):25867.139003648645
step: 130	loss: 13813.338893651962	speed (wps):25884.721597294392
step: 150	loss: 15826.001363992691	speed (wps):25904.258888226734
step: 170	loss: 17805.824414491653	speed (wps):25915.475821722903
step: 190	loss: 19668.353984355927	speed (wps):25927.630994376002
epoch: 35	train ppl: 18.61399984752879	val ppl: 513.626610604271	best val: 182.51584633074623	time (s) spent in epoch: 36.65146040916443

EPOCH 36 ------------------
step: 10	loss: 1089.9584829807281	speed (wps):24800.386678853967
step: 30	loss: 3189.9674785137177	speed (wps):25567.870291716612
step: 50	loss: 5163.428283929825	speed (wps):25736.37123491452
step: 70	loss: 7389.78734254837	speed (wps):25806.815214583323
step: 90	loss: 9290.981557369232	speed (wps):25849.301130610536
step: 110	loss: 11105.62861442566	speed (wps):25874.879042332104
step: 130	loss: 13149.033677577972	speed (wps):25892.540267395638
step: 150	loss: 15263.314019441605	speed (wps):25907.43378999703
step: 170	loss: 17169.980889558792	speed (wps):25918.335298748687
step: 190	loss: 18986.268362998962	speed (wps):25924.714575302114
epoch: 36	train ppl: 16.77247226723956	val ppl: 575.8642097923466	best val: 182.51584633074623	time (s) spent in epoch: 36.65978217124939

EPOCH 37 ------------------
step: 10	loss: 1105.2490532398224	speed (wps):24487.53034147435
step: 30	loss: 3323.6228489875793	speed (wps):25442.57428273296
step: 50	loss: 5199.281132221222	speed (wps):25661.606507275246
step: 70	loss: 7360.146685838699	speed (wps):25757.340415697898
step: 90	loss: 9297.193557024002	speed (wps):25807.225857836318
step: 110	loss: 11076.363583803177	speed (wps):25840.6922777438
step: 130	loss: 13134.86424446106	speed (wps):25865.153982240925
step: 150	loss: 15098.146579265594	speed (wps):25881.480764126496
step: 170	loss: 16926.36352300644	speed (wps):25894.85189789691
step: 190	loss: 18772.778087854385	speed (wps):25905.414439296947
epoch: 37	train ppl: 16.336842017763335	val ppl: 626.2498915928458	best val: 182.51584633074623	time (s) spent in epoch: 36.6863968372345

EPOCH 38 ------------------
step: 10	loss: 1025.1292288303375	speed (wps):24797.934960508363
step: 30	loss: 3052.3537397384644	speed (wps):25547.849335369014
step: 50	loss: 4952.3034834861755	speed (wps):25720.426091038884
step: 70	loss: 6900.123556852341	speed (wps):25794.792650057967
step: 90	loss: 8754.543319940567	speed (wps):25839.433333511646
step: 110	loss: 10545.07243514061	speed (wps):25868.23490675407
step: 130	loss: 12664.077801704407	speed (wps):25886.039897650186
step: 150	loss: 14513.208183050156	speed (wps):25901.18927143948
step: 170	loss: 16363.88147354126	speed (wps):25912.53046137579
step: 190	loss: 18131.142441034317	speed (wps):25920.825851320664
epoch: 38	train ppl: 14.72590681948404	val ppl: 666.0637130159425	best val: 182.51584633074623	time (s) spent in epoch: 36.66590476036072

EPOCH 39 ------------------
step: 10	loss: 1013.3361184597015	speed (wps):24798.101566790952
step: 30	loss: 3069.437984228134	speed (wps):25560.7908568883
step: 50	loss: 4827.695090770721	speed (wps):25719.97532229661
step: 70	loss: 6789.907925128937	speed (wps):25796.295419126312
step: 90	loss: 8546.025780439377	speed (wps):25837.953540414055
step: 110	loss: 10256.462366580963	speed (wps):25868.51595541431
step: 130	loss: 12364.578565359116	speed (wps):25887.278835836918
step: 150	loss: 14180.343405008316	speed (wps):25902.25874256751
step: 170	loss: 15887.526278495789	speed (wps):25914.228878447833
step: 190	loss: 17644.75593328476	speed (wps):25924.026394590303
epoch: 39	train ppl: 13.702512642419443	val ppl: 682.1732951795168	best val: 182.51584633074623	time (s) spent in epoch: 36.66568851470947

DONE

Saving learning curves to TRANSFORMER_SGD_model=TRANSFORMER_optimizer=SGD_initial_lr=20_batch_size=128_seq_len=35_hidden_size=512_num_layers=6_dp_keep_prob=.9_0/learning_curves.npy
